from absl.testing import absltest
from absl.testing import parameterized
import jax
import numpy as np

import util
from key_gen import (
    find_automorphism_index_2n_complex,
    gen_evaluation_key,
    gen_pke_pair,
    gen_rotation_key,
    precompute_rotation_key_map,
)

jax.config.update('jax_enable_x64', True)
jax.config.update('jax_traceback_filtering', 'off')

a =[[[26397333,40529637,41720310,109648610,90894218,9352993,3300891,13531460,4682835,81443226,120794548,59861135,24188589,10985166,70224738,2829644],
[39535783,123210485,86520317,83897275,104851510,94968656,12057881,43666540,88035081,21079448,51542166,104433159,40093529,113808827,132039534,98605859],
[7015905,94531381,6009200,27221197,93581713,26161385,88491980,72691019,110599378,34754138,2265796,121066064,74078380,51959238,8514882,118317315],
[114096873,40203391,72467076,114218547,28247853,20496745,16457174,33429084,47858610,24527561,87521689,63931171,85626376,37136597,41110993,8970476],
[57675740,93205314,5914050,25169683,24563153,67240936,128162349,35160334,127789069,25171724,106794739,54243398,56062456,86356211,89645077,29153075],
[92043096,112821151,72111288,130467426,7229153,127912321,26784123,124603980,75984065,53053018,62433181,109920865,22126972,95694536,306058,12495018],
[73706418,115777872,6851947,63856016,48160227,123358692,116011670,131316641,64047945,95840945,43787386,129815171,73914292,120971710,81360335,52196063],
[113072933,20242760,126556258,31904954,9737280,58231069,118570845,43815416,69629383,75903149,129527326,48058463,120869624,97930597,94204501,49758978],
[31991818,56202351,63507645,3119698,9545039,91257751,132717628,132732864,34096316,36510506,120951849,33852072,91448580,132815788,115688049,55895985],
[127136532,77759901,61023049,133372616,11240345,73165877,86020606,29050707,9292507,130933682,71897482,132462042,23280774,65079924,42362255,125997331],
[711328,104675530,65768657,126746607,44850226,86710134,14517420,115862876,68485085,45881460,11589849,77312358,124102368,72075104,133931068,81698410],
[90695641,61579584,68370895,6997439,131568228,56021691,32864189,12667068,114338491,133125607,30741861,79021862,21731388,111218716,95720660,72624309],
[30429584,42500331,122539609,74819966,94744811,59678178,51558820,112863003,117572290,51442130,19491452,115919764,69529894,132459114,68617779,7367777],
[31790195,126397688,126286878,128176123,65362480,91421216,80700280,122997474,63176688,125077269,108222692,91868899,123307288,44970707,116600527,10695752],
[83846280,114236882,21701804,125218730,84014180,8427451,10920855,56318726,37482030,45499934,64885617,98613252,84442620,49985581,78168694,60075114],
[5349275,100423668,10139365,111801279,23507860,106821800,94748089,17069169,97322382,84165033,55608286,67935397,97758513,34897954,121885919,92294034],
[87477833,75101073,40672272,118583637,105183546,15930496,3466127,980647,41312218,64514056,123361619,126309456,102905717,119443295,38754387,112608149],
[113025835,122690651,108118594,71512996,2594790,42872427,51224935,115708301,89699347,107767732,82758321,108264087,9187954,18881728,68498949,74973508],
[43355843,41122644,119158788,4362794,95441388,28582184,28763778,132555534,1018166,27438339,103965066,70931499,16258431,69865044,118503167,415197],
[19848178,59216895,79572693,118333215,97313988,14417862,40194883,67151314,37283084,81043535,78039090,130700419,5621770,125071815,119526971,63783693],
[28161013,33458969,116542725,102362542,75322840,16043811,101704949,95589791,74754440,72163936,58766463,63733700,17262687,53140925,129356552,35328212],
[36810057,5439434,2099287,50915512,34939180,37934358,30365610,31363822,89121557,86676866,37796874,24452061,62046592,14142155,130363964,131957371],
[4199035,96614922,36543571,104790234,10121451,107251311,106568861,67251712,89861492,81411237,56261822,108097367,1403291,77594411,4997968,37161403],
[64838570,59734896,107014140,21861954,54456268,102020364,21836976,76942321,39520217,115108101,85507141,27881474,51129423,104781873,28240378,69724599],
[113655317,112360505,88654958,28331366,66908988,13797424,87138434,16106088,13712956,111665984,109990521,57198490,111300762,105646785,127083393,123376364],
[65855562,44469982,130583065,64403380,120531276,65973245,123611681,77473310,90083334,83002953,109845022,119285915,25496192,66059288,30127224,126332975],
[63472018,49763342,131088478,84688401,23537434,71628102,3552699,102332998,884602,83326351,101449922,37376090,19347367,33115498,74443009,45202501],
[5297265,113134685,59716580,107535280,131351247,65374799,78539844,28789063,124393436,75216007,34318445,15132098,53143069,7487421,52985406,32660296],
[10479517,21275197,98743239,122106605,99781955,102406377,74445213,97669911,50836633,63465217,36403995,699737,52040395,86777520,99749806,14416970],
[1170,135547,71471,85055,94477,139641,79813,95570,322513,428283,444956,519321,261683,247767,90024,395365],
[239375624,113758244,254112812,9083834,50548172,103484698,235525326,226900515,103094505,26630457,78057887,141780,150085249,114516657,20361206,171401548],
[71729407,9026515,185794469,15750519,46857452,41272112,162326074,66173486,131568749,55302382,117695152,138859597,12970217,260304197,36475505,210046112],
[153096431,138905909,84864468,228685627,139017588,163931540,141090441,174901926,194384640,227620094,268104109,80531005,99809656,194059443,38105431,85591824],
[250111014,185431872,53109334,167612622,22911491,228288017,176819473,212177714,67183758,36846270,240850081,113770709,31634983,14465602,249359014,84854717],
[256721674,158162334,244811003,132063469,148136473,59255446,40825788,101938388,186687698,13259549,152082789,139824519,143134954,97264824,230702765,2211511],
[179776659,120693365,186098119,29710982,136842939,56536866,244732201,335640,215045079,70714459,95646412,94657749,213753691,29299349,104325706,184099303],
[154227326,33022441,151117376,107144358,32541037,201257046,145279846,10943373,63082413,44675449,178144747,186790599,221452079,16339189,106026515,33677612],
[227566592,83034899,193932338,173252267,223665071,40791134,97567360,19734399,149403421,171469534,172119161,14469833,202598438,124062185,81934309,142411898],
[90540543,115475675,199180335,236210845,64205339,130742788,265254111,114203229,44271173,49798304,148789124,10050060,123431636,236617519,103397682,249199612],
[155846816,70567848,37664703,12118314,95782893,253034497,191431073,119907874,9307603,96043111,146336886,5100075,119431236,240195122,39844145,168396160]],
[[20764815,124445379,36681409,44468370,132889181,54347986,131796225,20103384,11550952,72100501,35940815,53057193,54062985,95518331,86942306,46527414],
[65097581,126236418,27477359,62478721,122319149,129076138,102860764,132982085,64803485,119701633,78032234,133891787,124048558,57246963,81296866,92025216],
[35079922,113584047,13379854,64147864,26510379,92907243,130151374,122376393,27542644,39325524,132609638,43874531,120260395,52865226,46082093,45326562],
[54108248,72912585,98247536,73736122,92885017,30825430,17962050,32757180,126419523,21517709,11286302,108786413,112688644,88563937,61125184,946805],
[56857034,49414655,132325706,131023171,8663624,103822309,104072254,42704769,14896729,38071867,54117077,67899352,72200264,132107105,103405087,82073804],
[56258872,10386287,43000191,108727642,70764752,87186333,97058933,110329356,117655385,13225785,17845412,119681029,82401948,51704631,9946444,120837541],
[110373589,90976033,84337385,37105891,43638033,34575936,25381577,47812617,99779710,62879115,85560373,64926892,53493174,11738228,107251588,53895932],
[133809415,83105483,131788422,42155052,128415373,79926011,49374123,122635046,64988965,8280953,104436435,7412303,87600928,65829010,104853667,90555661],
[77039643,117070828,43165326,13648257,18187399,49848907,25075994,112724799,119693024,6161565,108344185,7842574,78771414,117958077,112605115,80439355],
[10709002,95022572,33714871,90437499,56477173,111043609,54538166,84962303,61858822,64285444,133233119,49969098,62021231,84517988,107233717,17901192],
[45014988,57007314,57594577,73161006,26841298,102637923,91768635,90453964,47193218,4812419,70305902,66338963,110216112,81098316,126020804,83877394],
[101406206,43709790,47666896,8147705,95081216,74953461,65061135,44705409,120008267,72198230,1312344,77687757,91636445,121765129,25266802,8102277],
[88804151,11290508,116917289,38260850,76900589,110658634,33952562,61444916,79486182,7017675,49215624,31964607,118131129,114909406,54742130,27967105],
[99909122,2892757,37394268,35615786,78080208,48149628,73592009,115789945,65424757,65842093,26701858,47203619,104812328,41694938,5622913,132303070],
[74635616,86512469,65959251,114908981,3097383,45669025,66535723,23690827,120487574,120939425,31589299,98549374,132551016,87514909,21581404,13361280],
[22948001,23653780,114116990,88664014,30055845,25071892,54005327,133271710,62026660,100315231,12577288,19690115,57891112,14589448,89684774,67534859],
[29742770,116467652,121952029,25575954,7963810,67228223,88256398,86679043,55541822,123609609,97456382,37120232,105294637,128023038,16323898,87622418],
[57129504,80836533,127453691,41905670,79629823,84304366,3664837,92636649,52905248,36738767,15121281,119872439,40231378,76950901,116155154,81416877],
[101232435,7866742,19819515,17261404,20271907,38600141,123958994,36305082,119565599,108053316,74681813,37587677,42693677,82559007,64762029,42069104],
[118546935,112519896,95176654,40475704,3075905,94436797,120294090,24236255,2244807,87232040,125412617,50144745,99554381,117228797,130514040,51467951],
[4572176,114908226,42230620,55081928,125943522,82449217,37545329,54762945,82850630,118739879,25179134,2954766,59649686,21451403,33365999,115533856],
[122482690,106726120,61500087,69546959,38918779,1648158,81989630,55210041,79650820,73222574,71731566,133046936,118806814,54825196,109855884,92148509],
[51076599,79138072,133223146,33009190,56691474,97788073,57397652,86430287,34587986,118888389,87467228,57692123,16607577,46677884,123790553,65711572],
[7357583,73218144,14501021,111411408,100560185,72408804,42411549,92387743,11522118,18414737,45640764,20563684,18627361,88368217,60998448,51142535],
[57627572,34675559,52548812,106656220,49560584,49735690,110621898,87951337,26968180,35722551,32838329,43127250,80156731,27318192,42675577,99691704],
[46761883,57682335,124127844,79907985,101331960,54499937,60108921,84627992,106448770,94756292,639205,24897756,128735442,130012716,117230139,60245522],
[98307727,124563911,8212053,64070183,92394436,132262155,66690444,74803217,55233020,85059940,3792462,39285078,47540060,60734205,489736,82611252],
[94790255,57587250,97420092,79156806,76575319,125126426,38301885,78499107,121758596,1630671,106214880,102869210,103930905,19031470,51956782,44876506],
[93220424,58622387,85376273,14389196,94607053,81268140,50398652,13500365,85131556,71192418,104416870,73504116,28692277,97417485,56523402,8599511],
[335833,90580,74158,503231,155281,419361,127534,360582,51065,185797,385295,280119,212861,321718,121794,53021],
[235159028,250171997,147995441,247788701,21194653,70339321,98421352,222660743,10280196,27326909,101145793,80661022,19041762,19989866,205733126,128041244],
[229533458,97961208,260516668,259204796,200596343,81711501,208844882,108702551,154309302,14444468,142722084,117709244,25704305,3728733,200206006,42714812],
[192838415,218425967,99912825,60556473,42155355,86481487,99118995,130840402,200420630,252962934,187835396,234750751,132899097,221452197,77124237,31845928],
[231394025,169217176,240682640,42873776,262795908,133966301,64890956,40100180,143161825,178837190,125065849,34169115,176861817,193105139,7426017,89472005],
[204920895,229566696,55336185,217947664,194507999,25729460,240861838,95484931,219591383,63282351,6317002,265228288,90937974,254511442,166839454,58029766],
[90854424,57349451,11862861,51327698,17503177,243411681,203878186,176600666,194582096,26299861,76862820,101274733,195051309,167701549,143280508,106768545],
[8075181,177952580,238428257,124739081,68365949,63065578,151756629,264782241,117746344,112924945,224388578,19653618,189108623,226250339,207497548,122193309],
[201098095,100770368,13611412,254086031,5722801,202631185,71490080,83073777,117639442,83428501,24558589,253020490,107515486,116223614,208665119,44413673],
[72997356,63775244,249780261,31368006,104538905,186171103,134004088,216367266,257355028,231538603,69455531,213406840,158798897,214888161,215028972,253495680],
[119951210,233617371,37467966,145316881,175010813,110699543,125482579,263478038,146017559,46782671,221842664,265972202,253166392,123298869,205370712,187321385]],
[[15755833,17706730,122522732,24587332,18131229,57493781,86177856,124974306,119543738,34921448,77341406,100871763,11459524,69307847,48098554,55774157],
[96598303,78202591,11433703,83383390,94949344,31242406,125792421,53590172,89557739,38515813,11734916,57987323,9211960,25678517,128526625,86031160],
[16199269,98651210,68853287,20026383,109627549,69026040,47972318,115075835,103269271,82975750,5482167,119605517,13411310,101874914,56370059,4999352],
[1857180,120279144,21926224,92653920,95677754,43012869,4609755,124309587,84140474,110278920,35118974,28626751,2844252,70126382,37581035,102167773],
[4214650,88194683,83399995,111993313,55485442,90505238,87692716,38890004,103987471,92354777,104180725,41450714,85045963,14909402,79945197,119512000],
[18446412,106403391,24120732,97255263,36494557,91194638,13173025,123252392,103825532,70925201,23605834,117740945,31948416,121864898,20933309,27801761],
[121681809,98304090,130640924,89244274,31111478,90766335,115690523,22841452,115430595,84837381,84984750,118637415,118434165,73009351,14522405,32791704],
[128072080,99035880,91471458,128238104,533020,2162910,7324368,60381158,112815562,49805309,109182429,55942275,112407359,77160420,64929113,133668794],
[89606946,108092918,95047528,126139966,24608146,84388544,98578860,85025201,40439699,113790058,122370551,83736871,32569476,95169049,25175649,102513963],
[22236142,86349480,110951017,123046858,30716667,121233807,123660143,131294768,125279646,79905732,122840357,95394424,79240499,72493832,15895880,133638607],
[79639527,96593970,22572976,112249173,118504494,85153738,72656186,43857371,71145582,97993050,56326346,63766670,100872676,131159353,47641343,27531207],
[46822825,4327646,10775529,87551865,108112225,24522075,30926853,29203165,49124701,34310848,51520977,29294770,70886349,12397186,78168597,118386793],
[97981694,66362640,74652580,42193463,105131397,22742624,6749317,97559040,91557067,62720585,113722903,77612165,80233643,128964785,16918741,5055501],
[56130757,88606495,48760632,130154068,129011573,68597242,39504912,16238439,47440784,128532709,86873518,60519227,50089243,20922176,23231264,133322657],
[122509759,118074612,22443506,55738680,118729940,108493526,100792885,14782129,87498602,94387766,24314615,118266288,118005225,1390940,93185758,118064078],
[73695686,5531520,89968741,4428687,121578092,91050752,112106170,35651347,128607904,82686054,114267772,83391206,100358343,50515380,103496904,59500817],
[18306064,32394372,5003566,130694423,89244508,9513492,90734588,12703390,37115779,100579954,94214900,109622698,24538919,3431858,102986839,129596723],
[30672132,58301274,22972102,12917178,115919566,122126781,7116424,20546396,73851039,90594860,97333325,19309258,31889679,51141445,84071967,124414449],
[3766862,58056025,43562899,93636730,49052032,29701919,111594974,30999842,72395490,64287050,88027030,99449654,122069385,65990758,36966684,12347029],
[112784659,110198632,83694001,3002050,97018148,21125287,25919889,61774872,104576368,49571015,26754292,74915808,52848649,18001731,101558846,90188309],
[30332233,8724767,113035310,117226967,10077308,69938665,123644141,114154442,47571565,48898129,78309579,47538265,133635955,85627358,45510182,30518533],
[113070360,35109777,74743952,89514276,12698778,14182887,125948677,64190979,4291641,80169740,76540825,47539037,105641071,123101388,95127566,40310052],
[73291668,109891452,9539008,105482394,114684221,21342404,22748374,35132414,46613222,81618674,127689693,36274654,127651981,27239830,88277489,6828616],
[101422728,62639067,20484484,37459727,16635469,39789365,11804238,70679457,99789735,15664366,53892902,90049908,110830140,35761087,127824373,65252987],
[108575495,14747866,19121861,10938772,119766004,21742504,111693794,44782928,15830640,105768954,82278204,49756763,97907114,365010,104389604,4976070],
[106856832,21188496,131065050,104178993,18357130,54094072,36094736,55184529,46500040,2392296,124522863,117824066,53640387,106235367,122304240,47311187],
[56630019,8338170,65362707,5871021,61032014,46587720,28517407,127173838,37281252,54136894,98714972,15811134,128871216,63123429,24994852,47663791],
[121311007,8348035,55007870,31395460,35619277,95840614,89514770,89248843,32085477,15145205,17538191,18360079,131259144,33355091,65299448,15236592],
[510732,35837522,114936223,19759040,21986800,131053954,93743343,118102139,120168045,107925659,21552477,43293666,109092898,40261580,123278277,73049836],
[79195,232134,160565,508040,268264,458606,128671,386432,443701,72388,395868,201949,380938,234450,378486,332760],
[267418641,241919648,179570880,196298054,135975781,156322887,8632304,145890172,117073283,158590158,241973145,257703036,201222827,141197861,216485950,80437889],
[78044220,164523721,256134718,86617798,162223060,225062957,15370769,15350616,5474514,87744972,33923496,244742251,170240141,225455982,266557488,70463262],
[76204075,74936541,196704910,189255680,30140377,14321245,121026625,78058189,198291721,241720678,146835329,141165505,245390395,6008609,268286351,202578297],
[262545355,263238811,244870408,74566685,93575045,240379103,109166956,157142629,79086046,102306389,66203081,154510547,71930048,51413056,105234694,26204928],
[204782089,174123789,108075956,251272290,65008573,24160397,30795241,246744396,268148711,162480747,137032018,82303789,185983875,78991087,189763684,201460693],
[232007255,95022566,35979834,134037022,66807840,117227128,32131868,168414590,64787113,20515731,100125716,260656638,17635170,45025387,26068575,78396511],
[29469395,250842746,31913547,21380087,155714385,195356686,163842806,119314559,164494680,264346458,195838092,66989741,175456567,15428413,130910304,215536314],
[95004510,93124458,198816552,66026729,197722091,193417285,227340043,207981892,69259936,267512646,13655350,123899934,184622080,114362168,197071205,14097828],
[193919516,102145799,68558295,169401632,71336939,182518381,220522590,142859395,35390243,173102923,170005818,224451757,20574004,235220467,104861891,59613935],
[137223809,82591026,263782770,81039297,163204037,48896596,88451525,18210,208171978,238835852,239512794,175406375,166789838,196371599,199956948,168966770]]]


e=[[[104079780,133538154,43329309,122751017,26219163,66368034,24592545,123487658,99999172,39241452,8928276,27307051,57065214,65546906,7332849,123975364],
[59104889,9914100,65549593,6303037,80936845,46852844,23922250,92053560,53838336,108920101,121195263,39019307,125624062,25512383,76018502,4677159],
[7369106,68103763,108579476,71181161,105059366,34678818,124597946,26795218,28563618,45766881,9754721,83307957,35435915,115311936,26151425,48805308],
[61757779,112893577,108916627,2724082,1560923,43986776,83148894,82825758,64403290,117060553,76561205,26383573,66364636,50464963,116821743,57784141],
[965579,5486204,468979,86366891,65398146,69522237,114091301,42632678,48509929,39164296,107957246,64436502,91770989,10476537,63930790,128279383],
[99680641,10173767,106340840,114369029,93797177,130237559,51517476,18279211,47374528,71712880,24523114,116613176,66159788,57609532,38215951,27056667],
[78361107,104378795,11459548,128827360,104791745,70053777,109146790,66585548,871082,76390409,112020159,126193749,123644920,33290096,79192602,116879891],
[130490032,109770000,97488286,82829194,82886474,66669728,90896676,17843983,129983852,107093310,26215518,65557166,115283063,119314375,90523344,9235857],
[79083137,13494108,65584186,39977568,47424159,10140482,131225782,103732112,83343791,55472529,58420364,8906746,92996432,41549623,119668547,122648938],
[1241381,72355076,52552689,83302448,114059195,126957586,26773127,66944165,117625470,71837659,87972332,133801359,34804810,63587050,28063998,125994992],
[35902731,116093642,17129631,105743392,48776360,46141604,129873976,39098957,121163892,124603719,94377276,11754542,85326645,31068137,78032519,122894602],
[32317827,41096576,133511180,31343634,26473791,89522172,103037439,88802378,51209807,132715614,113253307,96862131,5312672,14653821,89774366,23824029],
[109597028,9442798,88793780,60347889,64063260,96989795,73235235,130044132,33866988,126242818,13246065,2118068,123989810,54627821,2306398,84808075],
[7686845,47404865,71280666,102468818,108915736,22048841,129019822,16243784,79431851,50055378,8378486,17319431,73541935,124709266,47454706,33536905],
[45809280,49760700,8644846,81577783,48853278,30883767,34747845,37389005,23041329,48748317,126195577,51448945,50905161,128862214,595141,37837506],
[50319805,5664817,4817744,14288723,95124544,81378306,109304898,86475147,58967705,84364907,66274770,46161342,27358995,29603161,116862160,62534567],
[119968507,33197670,117710969,130239391,70519826,25304539,68122820,58509046,126924185,41994737,69776132,9063679,100559202,98174008,1366181,2302892],
[77717814,112010493,18127007,108214392,114437492,40475338,104242714,51702457,57146009,111647244,18434466,53898173,103863500,122632302,104060055,9330409],
[28069698,47273059,59988777,96202720,92026352,58355639,36119953,6252883,84927790,125439536,92639049,4105049,56246647,7962026,17267840,126639133],
[129863602,79781119,33986924,109770620,23094941,34382419,93683787,68799610,87252223,119193931,109157778,98960737,49038852,118874493,23699047,28402374],
[6731398,89771879,5023610,88903343,52468414,103115906,110888618,52739999,5912060,44464939,84793973,7558256,89339869,133769743,61520137,2510647],
[31145492,39722311,91106014,106943633,94287562,20333559,61175498,104519808,101227405,58285897,52661697,23778386,84589649,66886205,23491629,113570591],
[74655813,115963004,45761292,121680141,86908740,7486852,51763639,78940377,104628747,21219745,85081680,99414680,84263651,128564021,7814316,93830607],
[120854372,7142985,122925935,129093856,115398954,36567446,88134741,107190304,33688360,127583600,3966922,55366256,35227589,45371502,4750844,40472934],
[106582694,52133911,14960011,16699545,122512641,33400251,92548534,19808063,114747959,21524889,45343137,11025784,79406565,114502531,46733081,47608059],
[62519596,60912947,83355439,49322787,11754155,46455517,74877008,111524798,47427602,53554896,6659563,115715232,15065988,24202988,121040540,55139863],
[55357931,13898547,132396827,60614628,35582981,127904657,102785600,30712605,78884125,109143465,7802771,103254361,7007646,130049527,31106688,47249601],
[8228366,400266,34088601,99280867,79921857,37370059,28773755,84767458,54311477,57384914,15608599,30363409,125204600,111954737,69819657,102043129],
[89905558,48049412,107330675,9153045,116299082,117791766,12216976,59709439,100315599,96770008,39874676,109245295,14097851,28571384,103314094,21099676],
[448276,232982,484715,203411,118750,420964,321361,178697,364394,16397,218057,112723,429061,9377,459495,176052],
[235914260,268264317,235190755,112055807,215770806,69935326,141772496,247384010,198546325,46552324,25025462,73181425,121127557,48961042,29535025,78265839],
[254078888,113993619,159991419,63550625,102179474,69053301,158456903,119840820,248415561,188328018,173529386,3855265,146409062,164936789,250199546,199096293],
[185817368,188415097,100386643,252643260,13573791,97588764,199647741,24053161,81827720,175740079,223888593,44437534,68512407,117567985,1092908,103851676],
[16414264,101499446,113357855,170885724,32453348,114494137,85577070,196646338,133928197,211081444,214858114,218336371,36606239,106135630,145870038,249333441],
[187364288,222535967,159637553,72784328,140001865,196717807,151392119,118059904,123347631,98200157,213942118,106069822,10902294,168260634,264831383,181861627],
[146299842,104956278,247929865,242273937,159256185,94061405,212537218,114120762,41331840,253835527,104803344,147517037,120520565,201174079,163077954,62207899],
[81275213,26305506,59954797,208462489,137375704,184660932,246971225,158737981,8991191,117272170,66715337,68482706,210434210,183297277,113095539,7002594],
[218340233,110211104,16813585,187555936,140907745,132737721,31997073,261014529,149841725,161757310,73817110,207353150,12986623,8660675,120817415,44222041],
[109773249,132807931,81809966,161650854,49629872,53805171,266254212,59902414,186330994,125765762,20094605,27248852,229879060,91136779,14200037,310392],
[103627726,94585372,233544126,212442853,253976118,121966531,183021111,108871315,257420433,84606192,201656377,187978658,121830505,7534726,90359439,152475919]],
   [[86552735,54202931,10616662,50880719,55339832,123224391,73240914,82822836,13943565,7369556,121584214,99803620,38616433,118109900,94355868,43097864],
[88082946,37001588,131089474,65082829,35435134,124334839,107092135,82911292,91814558,132391573,15292019,37295736,59038736,89870573,79157696,31963297],
[15721094,121554186,121824606,69680374,63679865,18863552,79532076,45980083,43373604,50989453,63270207,70422168,25342502,81933907,50496568,16798466],
[2417540,18811240,65083877,126177813,2037224,46714396,89746109,51633780,15073587,132765043,55349438,20814867,54935442,53595461,25640194,44447947],
[56925085,29116696,133936528,1484612,114006651,39616924,58020170,103726354,41156530,102876734,87755641,34312105,85764509,31704492,122564234,30698775],
[83403186,62227803,57053286,66873057,92289016,44457166,63043654,67483548,122809712,34191515,19134638,10887145,19458512,97951408,84169358,14020747],
[127883630,32206334,64645761,34896814,23333077,85180150,103868196,64821106,23527313,121983583,78251849,20898204,63882003,19208049,102130072,106953995],
[113797703,6857642,79954879,31527868,129718365,58313802,49632743,67029378,113575809,122361806,10211687,2723818,14310377,6018030,18497237,114925519],
[25773840,3800045,78435157,17176050,72748574,121209027,134172454,83519153,77860138,80631691,913746,119691810,97270090,67980188,69860412,22626225],
[40301131,127092906,73460571,91302568,362801,79711809,113638327,10962523,2733231,91886643,31197640,28505611,58271456,102186398,89770376,132281281],
[39692021,106565237,52475301,63397559,35402521,118861767,62332692,58153666,127783311,121152404,53174992,62528048,118312389,39429314,69901631,78818868],
[12162447,131254821,17465994,109060685,85313659,76714277,42440533,62443004,76345277,17203680,80042627,54560736,64036454,2048259,65981575,42422955],
[84285592,22460677,119396317,58373088,98767243,4772641,11759082,2830379,13738325,80539960,115451254,83625278,82782474,56278276,65528959,38915502],
[115504364,47283412,59738903,60543003,7040639,70096207,34248650,8186577,28859775,127300780,12247411,66762661,56145029,5988054,130460605,109091361],
[72204766,119531894,5961375,89037204,51289153,39627842,86702260,72512702,106975601,77518106,20377231,77837449,20517826,128417258,92689591,12534134],
[81955749,35203608,126637202,53272091,43310895,4127125,33972543,24164366,91317154,34493619,18754030,23440937,22144684,38052835,49862458,124577862],
[52955732,120733508,124872677,125853634,81354389,81621690,30002360,53689687,26672421,60733349,15562446,121491551,121153143,31530599,130614744,29108687],
[8086026,78123093,125655940,111157935,65271130,133002883,53294384,96486366,42268020,107982631,2038944,81883057,114396761,89265678,83460336,15566777],
[117681441,67099224,54267491,18666596,90603374,130063312,85170376,107531223,134178498,14158389,96201269,36392818,102260497,63863790,38267080,51544087],
[51496952,83139508,85438583,17415271,91236744,73356671,103765921,31013706,120727440,35826480,70301485,35189581,9954140,123434557,48046553,93383120],
[72479082,52914762,76054665,10406622,93329344,79411443,53162129,99106461,4048834,308341,115334236,1612964,86130810,8380637,74467624,112364933],
[5993923,133068556,58679256,18475150,30622640,129498698,42654435,117870058,131141412,21386923,105968230,30157433,79398363,119775588,25034081,24000686],
[63116877,2156892,42648824,94211773,69817686,85744756,90451028,88731008,67253544,19732859,32511593,78333362,124627338,80724924,29282505,104412719],
[66441115,129742326,120112415,4581431,6311589,27604878,123071826,59002768,53169249,7656011,60940819,23761879,6358138,97851207,93336249,59577707],
[6911255,83983162,91486004,123079683,7351648,51173940,19580019,19093324,57251628,2466242,33471398,118588287,64166056,116211650,83673221,61050234],
[12901261,20511786,76178390,32172326,98008245,33767260,52257660,76858363,17875696,11586804,59872167,114151247,31275978,2129051,33347625,132416723],
[35110097,11522730,66008890,79242757,65255497,12075893,77211185,56229970,67196193,71668520,58696796,37687711,117601679,99812364,62389265,21823500],
[61166010,129862569,86461002,27787066,76244963,126152192,22803910,6391916,17084765,45095701,58374470,8052373,65473841,118960344,29159131,60451594],
[98140993,23750649,77896817,128834961,88129372,21841075,8438428,89840021,62551670,86590776,109468000,13410450,22834561,36279335,117532111,88205413],
[97127,424634,372317,141090,165712,452563,248788,195173,82462,244627,513073,205673,314353,25172,218679,493365],
[179573295,90266891,258818395,17848921,32259306,201489060,255264486,38221082,183582950,47039928,133142662,16022320,122864649,148112961,136249946,18290659],
[139602680,149086247,232475630,231046240,51773980,113547867,61043939,95163445,5369757,120695018,47980190,11052058,9813320,53808507,57593020,230558140],
[70995119,70017294,248153817,154233179,187641968,50438095,75825086,216435342,263934310,20101426,142294755,14991465,191567570,12478309,176681130,251690935],
[198630847,220242338,54182184,185105797,25533700,68986266,106274664,214783080,260450014,125162512,135477277,1110494,33596545,114790953,70087991,64628369],
[252976532,200563145,28504609,133123058,123769325,237769826,102104145,263361357,174226862,171403072,27896539,195188095,43278600,40763982,16355806,136190239],
[135335059,231233075,259125441,206621550,144379151,92038618,10475397,262960506,170563078,202855815,6841277,76372423,155656529,99740958,205878380,155826576],
[11479908,114102892,83047368,102673237,129485229,39673816,12964795,43439885,232911143,253288241,5896587,102493650,86654526,9860720,248724801,133904600],
[210326380,267195505,147199523,78018151,114806671,58999824,38314633,158873069,97650159,61173065,29821540,234305878,77605314,116831552,122295970,65616837],
[220890265,261738010,243655885,257726014,49497934,205211629,169560741,202319776,145687687,256791828,12250315,252042388,245849540,177631044,68019695,183894380],
[72986101,238409692,172150963,252603406,230953759,33082279,258684722,83294355,557636,31838827,170992301,167889802,255791878,61803235,128581856,256276685]],
[[66585143,133088442,102688681,132123995,89010576,75571277,37295349,61608954,57764928,80384913,74571916,7348634,96400505,101482421,76652491,15404008],
[54062584,130485027,15618747,80542626,45753312,70815874,126819725,41782530,41812545,39861952,84342722,130915643,81936353,101743567,123115538,38245616],
[116584923,76451049,7263513,53676116,100226414,111173183,102310353,38637000,87762982,99616329,22233457,41844352,116407182,11331624,1965800,86187331],
[118225732,21799562,110432004,35226383,62299237,80994277,96272052,1826318,70694259,111089026,15687451,120991586,46818741,3804339,96761321,80736264],
[133517000,33822027,112568906,37076069,53276872,58896051,49035146,54217742,49595406,64423046,84730966,77725680,132118923,129350297,91309572,46210530],
[54083143,62197675,41287766,88104797,27262204,128104391,44281876,113400090,103037704,34533202,81325602,108232333,33567694,81382503,127051236,80016833],
[762569,33351065,129527671,2972111,48197323,121562855,26941771,6398930,17037380,130406764,105414629,50932204,45195439,37115159,134089279,49556154],
[66379980,118404754,8476226,40792373,9352128,73527742,105078563,116779068,30592599,1699617,69521597,29542993,47378113,104579550,88382717,28968579],
[76210651,100514520,11704405,110984744,56172096,36470810,62433680,3695894,78640022,64337952,51602049,88680620,21358048,131936270,103449921,75476854],
[81807994,90558295,112897390,72425610,16481141,25649006,4780621,33414696,122336015,124694392,63503900,58721053,71414091,92361114,119348228,117479823],
[74382356,59435529,53176045,126578118,87161845,77618668,54388150,105275060,34218153,19167953,89515865,6111926,131430813,15071921,106792300,33436762],
[119677377,45477272,66345830,5440643,97566025,107555133,12101707,51450343,110350290,105520043,115364461,121791846,111803181,53930859,127245217,90518263],
[66710885,56778821,81647462,18565371,31480675,29835956,84748322,23237227,5215005,32080636,59417451,20092992,54218286,109990022,32862780,98408083],
[57914443,36714159,6010735,76887462,131671968,58594462,51326270,76236102,96409658,97452041,47754464,15826490,69973176,114821101,79701935,56416822],
[39020462,99027483,116716774,70762845,98265624,23377118,25362297,14534400,117141090,112760144,84783480,52589307,98357376,14464732,29136971,77434225],
[27699922,125657133,23561275,118352938,57050644,7411449,95451675,59302021,22368290,120485227,90188251,94903757,26490974,1134120,131491721,72166755],
[101635470,60417059,43593445,109592519,122248167,601550,21337041,99118126,48597963,121663997,49970787,76067920,118109959,111047390,121063070,2886090],
[53583297,34523506,89634001,80138023,6833931,16589389,77041990,100372758,53403506,46518401,85213039,107404027,44268601,120017361,22074108,1892853],
[113412130,99637901,44663032,69094948,23657758,67693827,22116441,34891882,130290505,81118138,56963931,32349749,97775532,52313023,90598001,57155994],
[44988529,78140005,67767439,101024063,98568080,74131004,78096611,70380442,116942452,94442553,127089674,60537693,119494637,113608083,32538315,64408750],
[24784286,77579966,93072733,131388051,62508976,134139349,58933126,115422827,70112854,75157683,52411228,55509179,119715422,130702435,132408815,8314280],
[9098066,25134194,68615925,111990101,107888628,12918107,65793711,104962834,133839232,61372477,83931168,111030753,84849534,126835403,30323085,69357831],
[37746114,9864341,74313330,99781079,106043876,112214471,22798694,18577316,25696221,46209350,49086191,13426964,34580613,92004411,22692358,40282869],
[49526265,86096070,89617381,758337,72103672,87757261,89963733,75101398,133940162,8683623,128171168,127316997,7660742,89186901,4143389,23709533],
[121959592,93294074,40246176,123850823,6241640,62062473,43188137,93587355,132654996,122903740,122628964,34685643,126069523,5230709,130089790,83503095],
[3266707,29977713,38508578,105715129,116124689,3672095,90216616,39690483,36086643,82993073,121947729,35368233,38504543,91166395,30341247,75949078],
[14912107,108905850,116342251,18238995,112484864,130201570,4761077,36623731,8304566,80280392,128119988,122829300,82720490,62258115,65649622,115338083],
[79611453,19493665,6405241,44287568,66184274,104848941,43736074,97738440,48831532,36663527,78290440,109889919,38552802,120267216,54310133,124627967],
[95877956,17395820,82419533,24924990,100973623,52260657,27777095,107584011,28519449,55681527,100970996,84117959,106756618,30862912,97299533,60321889],
[326757,409462,252889,82419,99752,230538,261635,511870,161623,21712,171070,136153,234209,122993,235029,412280],
[236007628,14688987,212450010,259048133,127460952,124504048,124600139,21009264,113764854,227935856,139130562,130331806,46532251,187162353,183286342,268004984],
[80871748,41915547,143788218,262171264,147674919,161436647,165918659,263140518,44003828,10987103,83691921,136398889,16271843,24979038,247383872,48410969],
[52457228,58497131,5559907,55101685,177043843,223549167,87088051,75995628,77792836,246894784,196243514,53412116,175664034,160612520,35433729,197698586],
[155268711,129536705,72480835,164196651,139158757,128458087,266615418,91638379,253678622,190491299,113288082,155357904,145093717,242308635,265018889,171756439],
[264506438,128578837,203065373,213501718,122398058,21395640,227787599,3301572,111469617,27431142,251626634,215421750,19189377,128233685,241005627,236996462],
[46642549,4928416,69277012,178578818,111546956,115056616,258448580,82747422,120124934,26043544,33207690,112061720,52021549,129561473,83562123,186793084],
[216666312,111499716,266159510,222219749,148653191,180634204,253188080,17757842,116933704,87366164,84734177,214172168,89203808,181946843,202792837,21973736],
[57797302,53162006,219119522,171584490,114834205,152117383,111699020,65664130,255102980,238461293,155399011,226178191,141993530,71951112,123166009,257670705],
[237656852,71747034,260033784,244744421,261604203,236381224,45675305,146124109,73674763,57865191,48234306,106565209,71926822,144345007,71105217,69783489],
[46551094,245043816,238526838,99464084,225207327,17304003,36096334,225114437,150024964,111827410,141064716,242648976,31743325,207034099,4384797,125428156]]]

sk=[[115623822,99810092,58323215,92790454,59296166,54865049,6352973,22948077,29337252,2406254,33930836,45821263,99147715,20872064,59568587,4227707],
[56152239,51568900,88173495,62742086,38330876,115401891,87989902,7408530,41579231,52727279,72671113,90801000,84878428,10152924,86213377,126857105],
[55318675,132954407,105612543,76245260,8720021,97623309,76036288,49047547,40123784,18072322,18135029,38970877,30709056,53035409,51567249,87290935],
[38188050,125287625,83010422,23078919,43653091,13202463,54282052,31673068,11214562,87819864,102730134,98945033,39143341,133020457,61172724,127236811],
[64983338,127901815,52022133,19003965,64034117,68762102,104435865,40112860,94964279,109895808,89613665,84343218,17760107,45510470,14879955,75442343],
[133884159,8200785,94346107,20658020,93715127,43219191,76765416,44150653,27947808,42452940,115609808,75745320,20969899,47731415,63385238,30671865],
[117823161,45153321,98245752,71315874,128122946,17118675,131340690,94835390,25486996,22765244,26193300,95962357,96830643,64593207,92982140,79109209],
[57796971,37331920,101071594,38593129,29964744,79564466,36192527,20150446,114090310,113553839,100977390,126232380,16398708,13028614,73904067,114813655],
[44956210,31012270,45175793,55395861,16847047,60824418,46377213,46475802,4139417,82171911,79439741,104518461,112973604,116854650,13758238,78539387],
[46589242,125298526,111604553,124926104,3253096,110962765,32907498,80108703,126161893,10131570,102730658,129854470,60288576,87855887,23750578,31449314],
[91597024,57211018,16065684,77472590,1677268,121239279,117113535,87589520,43295284,46884594,28271267,11900407,72487807,49866775,92609229,24260054],
[76360959,115981837,24593542,111344441,20944177,103808478,74723121,40339923,12198361,1504989,113670210,4644894,109260984,101375010,42869090,120090824],
[66211314,77215378,38672382,41050851,112214239,109109356,114114932,122126853,26440599,67853272,1252370,115017035,89700582,32070271,47025852,13644770],
[45829812,3391278,77014371,1478876,79609436,61652082,61494704,113671239,94043883,25808711,61491776,10312223,89944155,122034140,12809088,78911657],
[45571921,36867636,73785342,63899832,89121130,48799517,127732809,100889170,98195745,59887570,95549876,52250464,28976389,89875847,94518006,102029939],
[85699310,41904938,16644263,58712256,72397868,89351827,63003812,131514853,62360146,67916506,55871674,37462392,39312986,56916869,131305537,63340979],
[18884952,112772125,105875551,35176949,117933084,112899635,6132696,5515479,117303624,104710869,19515749,119507732,14995987,98984973,117306276,100434936],
[34601815,128722567,60725218,87626102,3773479,86046647,15317906,63978194,22087388,122220511,33617272,40483517,68995090,119135237,76777281,109616184],
[66723847,7981510,20668355,95634387,95586301,108304131,99161462,104504912,127044129,92740832,48546598,32194801,70773589,41925812,56763432,5178758],
[82756914,39502543,89719947,95757558,105880120,29815183,3470173,13728069,133154200,91017540,80367727,115984067,101702294,118728025,111148798,129425236],
[91431385,32881774,43350357,39145360,88080323,76462648,69495867,69268085,107198200,65327051,90494353,45460276,116190534,45209536,109001896,118947500],
[127120178,72632538,12454100,44121365,103832321,28079132,113588170,65496030,50043197,6009963,28394223,27796855,131960570,51108268,52257123,24615718],
[108004070,121297615,132873000,112725883,42575185,79876319,105580030,23706046,904953,66204747,53390317,31855870,1278799,65668367,120315987,7500500],
[88519523,105035758,41708644,120508885,2448999,118808592,39656647,6125499,47167633,46731184,51902951,58781471,34923619,53955096,89632294,33612812],
[117568182,49510795,5235849,104748384,88055116,51737771,84057000,122633714,97521907,128113576,68161118,106785605,129095481,66417146,5475972,117079178],
[110352267,29704285,12841338,123135224,126805015,71957942,16746629,20814273,67540195,3456684,81063937,83175521,13896111,77044887,93246086,7748621],
[87885187,61674879,33992695,129975710,46784565,58106388,132661039,114420125,80237476,109414280,87531566,116964022,129627551,20498571,66935568,65480452],
[73826788,109056429,73247054,37305902,40680522,121833937,100036452,55446484,1887130,101224963,103595627,26315156,106056116,28822018,85123134,9281544],
[2980925,107240337,31198425,8934949,15454386,60501826,117799101,86202885,115838774,61311267,98212635,418950,87764220,107897308,24476105,13294458],
[345592,46869,368306,78687,221924,358960,503740,95376,419669,164758,126654,27983,101367,186657,92450,7110]]


ek_ref_a=[[[26397333,40529637,41720310,109648610,90894218,9352993,3300891,13531460,4682835,81443226,120794548,59861135,24188589,10985166,70224738,2829644],
[39535783,123210485,86520317,83897275,104851510,94968656,12057881,43666540,88035081,21079448,51542166,104433159,40093529,113808827,132039534,98605859],
[7015905,94531381,6009200,27221197,93581713,26161385,88491980,72691019,110599378,34754138,2265796,121066064,74078380,51959238,8514882,118317315],
[114096873,40203391,72467076,114218547,28247853,20496745,16457174,33429084,47858610,24527561,87521689,63931171,85626376,37136597,41110993,8970476],
[57675740,93205314,5914050,25169683,24563153,67240936,128162349,35160334,127789069,25171724,106794739,54243398,56062456,86356211,89645077,29153075],
[92043096,112821151,72111288,130467426,7229153,127912321,26784123,124603980,75984065,53053018,62433181,109920865,22126972,95694536,306058,12495018],
[73706418,115777872,6851947,63856016,48160227,123358692,116011670,131316641,64047945,95840945,43787386,129815171,73914292,120971710,81360335,52196063],
[113072933,20242760,126556258,31904954,9737280,58231069,118570845,43815416,69629383,75903149,129527326,48058463,120869624,97930597,94204501,49758978],
[31991818,56202351,63507645,3119698,9545039,91257751,132717628,132732864,34096316,36510506,120951849,33852072,91448580,132815788,115688049,55895985],
[127136532,77759901,61023049,133372616,11240345,73165877,86020606,29050707,9292507,130933682,71897482,132462042,23280774,65079924,42362255,125997331],
[711328,104675530,65768657,126746607,44850226,86710134,14517420,115862876,68485085,45881460,11589849,77312358,124102368,72075104,133931068,81698410],
[90695641,61579584,68370895,6997439,131568228,56021691,32864189,12667068,114338491,133125607,30741861,79021862,21731388,111218716,95720660,72624309],
[30429584,42500331,122539609,74819966,94744811,59678178,51558820,112863003,117572290,51442130,19491452,115919764,69529894,132459114,68617779,7367777],
[31790195,126397688,126286878,128176123,65362480,91421216,80700280,122997474,63176688,125077269,108222692,91868899,123307288,44970707,116600527,10695752],
[83846280,114236882,21701804,125218730,84014180,8427451,10920855,56318726,37482030,45499934,64885617,98613252,84442620,49985581,78168694,60075114],
[5349275,100423668,10139365,111801279,23507860,106821800,94748089,17069169,97322382,84165033,55608286,67935397,97758513,34897954,121885919,92294034],
[87477833,75101073,40672272,118583637,105183546,15930496,3466127,980647,41312218,64514056,123361619,126309456,102905717,119443295,38754387,112608149],
[113025835,122690651,108118594,71512996,2594790,42872427,51224935,115708301,89699347,107767732,82758321,108264087,9187954,18881728,68498949,74973508],
[43355843,41122644,119158788,4362794,95441388,28582184,28763778,132555534,1018166,27438339,103965066,70931499,16258431,69865044,118503167,415197],
[19848178,59216895,79572693,118333215,97313988,14417862,40194883,67151314,37283084,81043535,78039090,130700419,5621770,125071815,119526971,63783693],
[28161013,33458969,116542725,102362542,75322840,16043811,101704949,95589791,74754440,72163936,58766463,63733700,17262687,53140925,129356552,35328212],
[36810057,5439434,2099287,50915512,34939180,37934358,30365610,31363822,89121557,86676866,37796874,24452061,62046592,14142155,130363964,131957371],
[4199035,96614922,36543571,104790234,10121451,107251311,106568861,67251712,89861492,81411237,56261822,108097367,1403291,77594411,4997968,37161403],
[64838570,59734896,107014140,21861954,54456268,102020364,21836976,76942321,39520217,115108101,85507141,27881474,51129423,104781873,28240378,69724599],
[113655317,112360505,88654958,28331366,66908988,13797424,87138434,16106088,13712956,111665984,109990521,57198490,111300762,105646785,127083393,123376364],
[65855562,44469982,130583065,64403380,120531276,65973245,123611681,77473310,90083334,83002953,109845022,119285915,25496192,66059288,30127224,126332975],
[63472018,49763342,131088478,84688401,23537434,71628102,3552699,102332998,884602,83326351,101449922,37376090,19347367,33115498,74443009,45202501],
[5297265,113134685,59716580,107535280,131351247,65374799,78539844,28789063,124393436,75216007,34318445,15132098,53143069,7487421,52985406,32660296],
[10479517,21275197,98743239,122106605,99781955,102406377,74445213,97669911,50836633,63465217,36403995,699737,52040395,86777520,99749806,14416970],
[1170,135547,71471,85055,94477,139641,79813,95570,322513,428283,444956,519321,261683,247767,90024,395365],
[239375624,113758244,254112812,9083834,50548172,103484698,235525326,226900515,103094505,26630457,78057887,141780,150085249,114516657,20361206,171401548],
[71729407,9026515,185794469,15750519,46857452,41272112,162326074,66173486,131568749,55302382,117695152,138859597,12970217,260304197,36475505,210046112],
[153096431,138905909,84864468,228685627,139017588,163931540,141090441,174901926,194384640,227620094,268104109,80531005,99809656,194059443,38105431,85591824],
[250111014,185431872,53109334,167612622,22911491,228288017,176819473,212177714,67183758,36846270,240850081,113770709,31634983,14465602,249359014,84854717],
[256721674,158162334,244811003,132063469,148136473,59255446,40825788,101938388,186687698,13259549,152082789,139824519,143134954,97264824,230702765,2211511],
[179776659,120693365,186098119,29710982,136842939,56536866,244732201,335640,215045079,70714459,95646412,94657749,213753691,29299349,104325706,184099303],
[154227326,33022441,151117376,107144358,32541037,201257046,145279846,10943373,63082413,44675449,178144747,186790599,221452079,16339189,106026515,33677612],
[227566592,83034899,193932338,173252267,223665071,40791134,97567360,19734399,149403421,171469534,172119161,14469833,202598438,124062185,81934309,142411898],
[90540543,115475675,199180335,236210845,64205339,130742788,265254111,114203229,44271173,49798304,148789124,10050060,123431636,236617519,103397682,249199612],
[155846816,70567848,37664703,12118314,95782893,253034497,191431073,119907874,9307603,96043111,146336886,5100075,119431236,240195122,39844145,168396160]],
[[20764815,124445379,36681409,44468370,132889181,54347986,131796225,20103384,11550952,72100501,35940815,53057193,54062985,95518331,86942306,46527414],
[65097581,126236418,27477359,62478721,122319149,129076138,102860764,132982085,64803485,119701633,78032234,133891787,124048558,57246963,81296866,92025216],
[35079922,113584047,13379854,64147864,26510379,92907243,130151374,122376393,27542644,39325524,132609638,43874531,120260395,52865226,46082093,45326562],
[54108248,72912585,98247536,73736122,92885017,30825430,17962050,32757180,126419523,21517709,11286302,108786413,112688644,88563937,61125184,946805],
[56857034,49414655,132325706,131023171,8663624,103822309,104072254,42704769,14896729,38071867,54117077,67899352,72200264,132107105,103405087,82073804],
[56258872,10386287,43000191,108727642,70764752,87186333,97058933,110329356,117655385,13225785,17845412,119681029,82401948,51704631,9946444,120837541],
[110373589,90976033,84337385,37105891,43638033,34575936,25381577,47812617,99779710,62879115,85560373,64926892,53493174,11738228,107251588,53895932],
[133809415,83105483,131788422,42155052,128415373,79926011,49374123,122635046,64988965,8280953,104436435,7412303,87600928,65829010,104853667,90555661],
[77039643,117070828,43165326,13648257,18187399,49848907,25075994,112724799,119693024,6161565,108344185,7842574,78771414,117958077,112605115,80439355],
[10709002,95022572,33714871,90437499,56477173,111043609,54538166,84962303,61858822,64285444,133233119,49969098,62021231,84517988,107233717,17901192],
[45014988,57007314,57594577,73161006,26841298,102637923,91768635,90453964,47193218,4812419,70305902,66338963,110216112,81098316,126020804,83877394],
[101406206,43709790,47666896,8147705,95081216,74953461,65061135,44705409,120008267,72198230,1312344,77687757,91636445,121765129,25266802,8102277],
[88804151,11290508,116917289,38260850,76900589,110658634,33952562,61444916,79486182,7017675,49215624,31964607,118131129,114909406,54742130,27967105],
[99909122,2892757,37394268,35615786,78080208,48149628,73592009,115789945,65424757,65842093,26701858,47203619,104812328,41694938,5622913,132303070],
[74635616,86512469,65959251,114908981,3097383,45669025,66535723,23690827,120487574,120939425,31589299,98549374,132551016,87514909,21581404,13361280],
[22948001,23653780,114116990,88664014,30055845,25071892,54005327,133271710,62026660,100315231,12577288,19690115,57891112,14589448,89684774,67534859],
[29742770,116467652,121952029,25575954,7963810,67228223,88256398,86679043,55541822,123609609,97456382,37120232,105294637,128023038,16323898,87622418],
[57129504,80836533,127453691,41905670,79629823,84304366,3664837,92636649,52905248,36738767,15121281,119872439,40231378,76950901,116155154,81416877],
[101232435,7866742,19819515,17261404,20271907,38600141,123958994,36305082,119565599,108053316,74681813,37587677,42693677,82559007,64762029,42069104],
[118546935,112519896,95176654,40475704,3075905,94436797,120294090,24236255,2244807,87232040,125412617,50144745,99554381,117228797,130514040,51467951],
[4572176,114908226,42230620,55081928,125943522,82449217,37545329,54762945,82850630,118739879,25179134,2954766,59649686,21451403,33365999,115533856],
[122482690,106726120,61500087,69546959,38918779,1648158,81989630,55210041,79650820,73222574,71731566,133046936,118806814,54825196,109855884,92148509],
[51076599,79138072,133223146,33009190,56691474,97788073,57397652,86430287,34587986,118888389,87467228,57692123,16607577,46677884,123790553,65711572],
[7357583,73218144,14501021,111411408,100560185,72408804,42411549,92387743,11522118,18414737,45640764,20563684,18627361,88368217,60998448,51142535],
[57627572,34675559,52548812,106656220,49560584,49735690,110621898,87951337,26968180,35722551,32838329,43127250,80156731,27318192,42675577,99691704],
[46761883,57682335,124127844,79907985,101331960,54499937,60108921,84627992,106448770,94756292,639205,24897756,128735442,130012716,117230139,60245522],
[98307727,124563911,8212053,64070183,92394436,132262155,66690444,74803217,55233020,85059940,3792462,39285078,47540060,60734205,489736,82611252],
[94790255,57587250,97420092,79156806,76575319,125126426,38301885,78499107,121758596,1630671,106214880,102869210,103930905,19031470,51956782,44876506],
[93220424,58622387,85376273,14389196,94607053,81268140,50398652,13500365,85131556,71192418,104416870,73504116,28692277,97417485,56523402,8599511],
[335833,90580,74158,503231,155281,419361,127534,360582,51065,185797,385295,280119,212861,321718,121794,53021],
[235159028,250171997,147995441,247788701,21194653,70339321,98421352,222660743,10280196,27326909,101145793,80661022,19041762,19989866,205733126,128041244],
[229533458,97961208,260516668,259204796,200596343,81711501,208844882,108702551,154309302,14444468,142722084,117709244,25704305,3728733,200206006,42714812],
[192838415,218425967,99912825,60556473,42155355,86481487,99118995,130840402,200420630,252962934,187835396,234750751,132899097,221452197,77124237,31845928],
[231394025,169217176,240682640,42873776,262795908,133966301,64890956,40100180,143161825,178837190,125065849,34169115,176861817,193105139,7426017,89472005],
[204920895,229566696,55336185,217947664,194507999,25729460,240861838,95484931,219591383,63282351,6317002,265228288,90937974,254511442,166839454,58029766],
[90854424,57349451,11862861,51327698,17503177,243411681,203878186,176600666,194582096,26299861,76862820,101274733,195051309,167701549,143280508,106768545],
[8075181,177952580,238428257,124739081,68365949,63065578,151756629,264782241,117746344,112924945,224388578,19653618,189108623,226250339,207497548,122193309],
[201098095,100770368,13611412,254086031,5722801,202631185,71490080,83073777,117639442,83428501,24558589,253020490,107515486,116223614,208665119,44413673],
[72997356,63775244,249780261,31368006,104538905,186171103,134004088,216367266,257355028,231538603,69455531,213406840,158798897,214888161,215028972,253495680],
[119951210,233617371,37467966,145316881,175010813,110699543,125482579,263478038,146017559,46782671,221842664,265972202,253166392,123298869,205370712,187321385]],
[[15755833,17706730,122522732,24587332,18131229,57493781,86177856,124974306,119543738,34921448,77341406,100871763,11459524,69307847,48098554,55774157],
[96598303,78202591,11433703,83383390,94949344,31242406,125792421,53590172,89557739,38515813,11734916,57987323,9211960,25678517,128526625,86031160],
[16199269,98651210,68853287,20026383,109627549,69026040,47972318,115075835,103269271,82975750,5482167,119605517,13411310,101874914,56370059,4999352],
[1857180,120279144,21926224,92653920,95677754,43012869,4609755,124309587,84140474,110278920,35118974,28626751,2844252,70126382,37581035,102167773],
[4214650,88194683,83399995,111993313,55485442,90505238,87692716,38890004,103987471,92354777,104180725,41450714,85045963,14909402,79945197,119512000],
[18446412,106403391,24120732,97255263,36494557,91194638,13173025,123252392,103825532,70925201,23605834,117740945,31948416,121864898,20933309,27801761],
[121681809,98304090,130640924,89244274,31111478,90766335,115690523,22841452,115430595,84837381,84984750,118637415,118434165,73009351,14522405,32791704],
[128072080,99035880,91471458,128238104,533020,2162910,7324368,60381158,112815562,49805309,109182429,55942275,112407359,77160420,64929113,133668794],
[89606946,108092918,95047528,126139966,24608146,84388544,98578860,85025201,40439699,113790058,122370551,83736871,32569476,95169049,25175649,102513963],
[22236142,86349480,110951017,123046858,30716667,121233807,123660143,131294768,125279646,79905732,122840357,95394424,79240499,72493832,15895880,133638607],
[79639527,96593970,22572976,112249173,118504494,85153738,72656186,43857371,71145582,97993050,56326346,63766670,100872676,131159353,47641343,27531207],
[46822825,4327646,10775529,87551865,108112225,24522075,30926853,29203165,49124701,34310848,51520977,29294770,70886349,12397186,78168597,118386793],
[97981694,66362640,74652580,42193463,105131397,22742624,6749317,97559040,91557067,62720585,113722903,77612165,80233643,128964785,16918741,5055501],
[56130757,88606495,48760632,130154068,129011573,68597242,39504912,16238439,47440784,128532709,86873518,60519227,50089243,20922176,23231264,133322657],
[122509759,118074612,22443506,55738680,118729940,108493526,100792885,14782129,87498602,94387766,24314615,118266288,118005225,1390940,93185758,118064078],
[73695686,5531520,89968741,4428687,121578092,91050752,112106170,35651347,128607904,82686054,114267772,83391206,100358343,50515380,103496904,59500817],
[18306064,32394372,5003566,130694423,89244508,9513492,90734588,12703390,37115779,100579954,94214900,109622698,24538919,3431858,102986839,129596723],
[30672132,58301274,22972102,12917178,115919566,122126781,7116424,20546396,73851039,90594860,97333325,19309258,31889679,51141445,84071967,124414449],
[3766862,58056025,43562899,93636730,49052032,29701919,111594974,30999842,72395490,64287050,88027030,99449654,122069385,65990758,36966684,12347029],
[112784659,110198632,83694001,3002050,97018148,21125287,25919889,61774872,104576368,49571015,26754292,74915808,52848649,18001731,101558846,90188309],
[30332233,8724767,113035310,117226967,10077308,69938665,123644141,114154442,47571565,48898129,78309579,47538265,133635955,85627358,45510182,30518533],
[113070360,35109777,74743952,89514276,12698778,14182887,125948677,64190979,4291641,80169740,76540825,47539037,105641071,123101388,95127566,40310052],
[73291668,109891452,9539008,105482394,114684221,21342404,22748374,35132414,46613222,81618674,127689693,36274654,127651981,27239830,88277489,6828616],
[101422728,62639067,20484484,37459727,16635469,39789365,11804238,70679457,99789735,15664366,53892902,90049908,110830140,35761087,127824373,65252987],
[108575495,14747866,19121861,10938772,119766004,21742504,111693794,44782928,15830640,105768954,82278204,49756763,97907114,365010,104389604,4976070],
[106856832,21188496,131065050,104178993,18357130,54094072,36094736,55184529,46500040,2392296,124522863,117824066,53640387,106235367,122304240,47311187],
[56630019,8338170,65362707,5871021,61032014,46587720,28517407,127173838,37281252,54136894,98714972,15811134,128871216,63123429,24994852,47663791],
[121311007,8348035,55007870,31395460,35619277,95840614,89514770,89248843,32085477,15145205,17538191,18360079,131259144,33355091,65299448,15236592],
[510732,35837522,114936223,19759040,21986800,131053954,93743343,118102139,120168045,107925659,21552477,43293666,109092898,40261580,123278277,73049836],
[79195,232134,160565,508040,268264,458606,128671,386432,443701,72388,395868,201949,380938,234450,378486,332760],
[267418641,241919648,179570880,196298054,135975781,156322887,8632304,145890172,117073283,158590158,241973145,257703036,201222827,141197861,216485950,80437889],
[78044220,164523721,256134718,86617798,162223060,225062957,15370769,15350616,5474514,87744972,33923496,244742251,170240141,225455982,266557488,70463262],
[76204075,74936541,196704910,189255680,30140377,14321245,121026625,78058189,198291721,241720678,146835329,141165505,245390395,6008609,268286351,202578297],
[262545355,263238811,244870408,74566685,93575045,240379103,109166956,157142629,79086046,102306389,66203081,154510547,71930048,51413056,105234694,26204928],
[204782089,174123789,108075956,251272290,65008573,24160397,30795241,246744396,268148711,162480747,137032018,82303789,185983875,78991087,189763684,201460693],
[232007255,95022566,35979834,134037022,66807840,117227128,32131868,168414590,64787113,20515731,100125716,260656638,17635170,45025387,26068575,78396511],
[29469395,250842746,31913547,21380087,155714385,195356686,163842806,119314559,164494680,264346458,195838092,66989741,175456567,15428413,130910304,215536314],
[95004510,93124458,198816552,66026729,197722091,193417285,227340043,207981892,69259936,267512646,13655350,123899934,184622080,114362168,197071205,14097828],
[193919516,102145799,68558295,169401632,71336939,182518381,220522590,142859395,35390243,173102923,170005818,224451757,20574004,235220467,104861891,59613935],
[137223809,82591026,263782770,81039297,163204037,48896596,88451525,18210,208171978,238835852,239512794,175406375,166789838,196371599,199956948,168966770]]]

ek_ref_b=[[[63451356,125899534,83519648,52728642,82157849,1259037,65098084,20583164,78496632,46611832,100862833,12908486,123216801,128528281,10911526,55599744],
[104330539,57133920,126167955,70848389,31706474,112788066,40327664,94638407,121371574,104877048,87627878,97840439,106282049,4257646,6958451,48486824],
[54329386,112862778,10322591,11978226,112402113,27399628,42499590,45414609,94339088,134024177,51539410,38766985,56791651,78538762,47773151,38026446],
[107481712,18118364,16018010,60414530,14306453,35855892,132713304,62794163,22378006,20315700,60033965,115504100,101868745,85201476,114383673,89335780],
[40232635,57785754,122962773,100465669,92974775,53497544,25012160,24714914,68303845,45035640,117106288,3539474,122824055,80639794,67629395,122547975],
[82280571,89442815,100106618,21874485,104071245,127721388,133160134,52471746,66511755,49617216,12726965,66316265,118117675,118249182,120973849,112033270],
[134114277,101318109,11962566,58412403,35034922,66206745,103311547,77025788,85712738,53164961,101071835,97126135,47672403,118801414,89281558,31784953],
[84482647,11191946,107833438,42834407,80797512,35056392,40723467,117863673,15515658,73774461,52985178,123803234,47079440,63793727,27135805,32510933],
[8270328,102114763,121877038,85743029,103389664,14848775,69331570,78372931,82685990,63893999,131724742,59818916,130197349,89728443,130519746,44938579],
[95868484,101065112,2038103,45397116,7694320,70883487,40598845,80689302,46462513,5315707,76696338,86310121,79388294,98246677,85783875,66106362],
[90064393,105916342,94952704,40729083,54603730,125897202,132812875,104507821,17320562,111568179,56162123,37795446,33237099,62659292,845381,130940196],
[52305783,128581850,125940464,32438591,89235960,31365260,31340566,66600861,76695279,125297893,38954024,114526960,81741292,97729487,52211677,88281240],
[68663097,126075879,87304491,25465973,48046043,132111859,99226208,84325925,125032864,7300585,126696718,50431835,46484824,28659272,76642518,67283091],
[32079092,85450981,123641339,4859736,33948589,94729210,18174618,21861231,74376821,125738815,89103306,27095550,26725873,33515225,107401114,62951335],
[90225734,25443556,133419990,60710726,118552829,71521914,245420,4257700,91867196,66007619,624207,102745256,54789302,6113644,59571648,67598213],
[58725760,127098677,35371052,98881597,27316058,90530473,66693358,95977531,37072019,26736803,10354607,44411281,58083519,40377596,21724188,46290420],
[68851474,69778870,96074874,131525298,39369273,66691419,74873540,120858496,98174204,28781986,9383032,105297101,77433989,61282638,128367829,32274345],
[124976662,107634396,111269219,12551736,21885538,5798119,115507278,130539552,4375403,6258802,132825346,68595027,69473968,91126707,76879895,121863606],
[79299856,64739323,50726904,99056337,57183856,106930919,121079739,109537043,287171,35061278,45449998,50233452,119962505,85543267,90683256,71929987],
[31187051,101373591,104417777,24123918,133216268,33492908,37639073,76847737,12595439,99851541,72760497,78526521,10069418,58282770,57903024,12593989],
[59064716,111537739,32767816,36609353,131115895,26120503,47189226,22876755,79578052,26212062,100561408,42951017,130720680,65544425,22273182,84482285],
[38342267,105924039,38675390,21703453,110344851,4425313,14499419,37459527,89412993,46766870,61917056,118097277,41827965,122899166,39549507,48067867],
[45323655,128488650,76826270,42908814,27399993,87897087,23551005,120841239,46472746,86786905,79345541,16859870,74698952,129219651,8113316,102486826],
[38680646,7267506,116424596,16585754,103620093,32421507,113989635,15725075,56465211,8924226,53427473,2192793,101393019,7879447,17174731,89326475],
[44273584,3019284,44344259,5316225,85333661,114595252,106120148,75138307,124586725,77876668,76133262,74680315,101784317,129193881,99881867,37986272],
[109200309,2262982,22542361,128996896,128374230,105045211,56915156,72945543,91194863,60075020,72874208,13949484,109167972,9223313,25276909,15372794],
[78721819,12236382,45020240,24754909,9620515,107978636,43534479,28110939,80354989,20509050,29964369,101442083,47330100,31597182,78414873,115616693],
[84306975,100385086,95041200,123582437,101324168,99817165,104947793,106609281,120426024,70404273,111859432,101864816,133354035,63919081,76922270,64719736],
[22954678,86484680,95944388,88450304,113129970,88661987,75594548,99836707,59883717,127165032,12452562,86718049,2360424,72427760,132582590,54540874],
[381799,341587,331542,322318,184060,412639,87016,446929,274322,197799,123861,396575,377964,499058,271511,187335],
[194793332,118510390,218544699,194612871,93983420,21758943,151276243,226813508,86260540,235802959,150052203,130563807,207058914,84633210,130892957,223237535],
[70595450,263743553,5826258,112254042,190775459,24650239,104694278,108249821,247736221,199630759,229692441,247860691,139184644,29976407,187918992,83869661],
[219215889,237068116,153419369,163962200,170643777,123109414,256905514,104134218,106471934,223441350,87624479,20964187,85564025,119836762,79669405,177721401],
[99510050,198365374,264633800,78192773,201504746,208946980,160616733,164807864,68162853,257469132,116150021,178360839,6802224,72963431,98972482,236838403],
[151616799,134689134,46774265,211679529,221685990,247194656,77539293,253971936,224918535,201019736,151554769,186027169,72081165,192749067,102709723,40938934],
[107979812,95183098,56744464,252278668,23088715,79537347,223341022,227731161,247062857,85045488,59657132,60884446,95948531,101950214,47008945,17152290],
[231993313,207352388,187625636,133756880,14353845,76859581,197518829,158813920,153723102,192104150,27403312,5319708,116294048,102077901,184831355,127173546],
[227098181,102542603,173196919,175884574,84598837,73156183,63749982,97002251,216184129,15182843,188641661,178001232,138678385,178104820,4681447,3939043],
[146509675,208131136,119918373,234480606,77233958,8602888,176854879,222510026,89587777,258806374,207751540,53888439,70528951,23720419,169685136,34829288],
[194758196,204711857,62008978,108659371,34201739,260837301,259599143,210479773,206405315,151188053,38136136,93217536,57419045,45487258,235854047,153716928]],
[[73818517,48088519,54728369,22033381,73546626,90713140,121901155,27195505,89241696,53092703,122890156,126780701,1321471,13080219,128350638,119360404],
[15273802,52158632,50963570,66109418,18144427,17616729,15199156,91017478,22256343,117293226,103692222,48401209,56016425,11109578,79293964,21347479],
[88648938,4040786,95299561,90039645,45344537,108056834,79015580,13128089,47574515,71418225,67902825,127185492,94634314,3754365,99522742,45230754],
[37838758,44101755,124331129,10336998,27676182,94213196,73841154,18111052,86884519,127666076,24185125,29613124,33626266,112203816,26009903,120339362],
[90240186,51528005,3139771,132569289,12737810,40660642,13414010,120983525,73476716,36778745,71468678,109602945,8082570,124195633,122007843,21255166],
[88908512,65585244,78870417,134192683,118012713,20672087,3255079,99105258,57737980,112895792,121944941,85094705,24067173,12809149,124056354,5745351],
[37396333,64928881,91907995,111784926,116680653,97457600,25037951,99521253,10245678,109451775,41623255,118296478,76918598,118689742,94943350,116974000],
[783607,208312,52824773,52022105,116018459,108459405,5212169,69583372,58493493,115963328,6931442,35457763,106709930,114847300,30307958,81046438],
[83929516,43533959,54633549,109195269,59247632,7772934,48937138,51077745,19538377,3323710,29694952,1904166,78875258,10153825,79793010,42434219],
[95596748,76076452,111296653,101286245,73075914,73624451,128813318,40918219,90127106,89768885,73848443,88055100,54221146,131967508,98694349,75690301],
[80909731,105000719,60327942,74139537,96284001,98665189,47613033,38585142,8674272,31799302,89640267,126927914,73375418,61954441,113089286,88811269],
[20885135,137601,61609369,51462826,107185764,114632000,120346426,79885500,30476913,45455034,82012798,123292007,19310525,10547334,61171932,58815737],
[534851,66872901,85104848,48634199,2251402,45948999,105053153,5519313,3667133,40711345,7284617,50972107,110628799,9034844,98050048,89056047],
[5295406,117221268,27550395,57842827,47624048,85608198,82008575,75732962,7603401,127497214,63297731,54566628,43353253,72351624,103490355,116073881],
[73674621,132730157,32965368,11325618,64474120,44133599,58496148,95189046,35154964,39850608,105671915,97389439,4727676,126282868,10020963,17039143],
[102391280,121607920,73111175,98310327,126346353,8632672,72773160,112135705,38214916,81833472,62161142,73547941,73130273,34545005,85850724,35133121],
[122786721,34232864,112348930,110859568,61734033,73580898,128833772,28273884,116421407,36221711,7213103,41958776,51420573,78075054,4077368,132666183],
[18676980,72992276,58941809,32719864,52178342,106029450,95630078,124245737,111459455,5729901,10952442,70152324,53967210,46992205,43584880,106592981],
[26640081,107788461,80522477,70830674,67053220,37240867,79706473,93648416,23372763,120193452,106236541,55327255,128265303,133346362,92836460,26954220],
[25814680,44581020,77549486,25711667,5987704,3636958,94289833,37234537,24259445,60769431,80851804,89521442,8720172,9704898,116226375,105907074],
[115225171,29898241,51415582,85724634,128461694,12878661,26915253,51777981,4232103,19677180,46191777,99369780,55137887,65623380,44385205,42985883],
[104196492,89489325,49288213,67952701,70896479,58209771,38829078,91087785,40182602,93588151,40763183,23005634,82171388,81692060,11771820,94469287],
[26051322,132685899,15824840,19529841,89433360,1781562,82496364,20540266,5289625,66200812,121396492,122390999,91175018,76069112,113171895,8931149],
[95391596,111484278,102366565,97410668,63419827,41918229,4944444,18728951,51438821,74351311,5432843,95977741,77453533,122148276,99112329,68305947],
[109008799,133849556,41904921,107713335,34732634,132428048,20536569,120241963,58737423,11579438,11437227,86707574,117360056,47394847,108185520,86902393],
[67783107,19337794,117433344,90224949,133954814,23097635,125531525,46087845,89237981,90471286,88484495,4656136,102307570,60165327,107694823,44353108],
[101847888,17543409,21726327,98388416,81445555,83099760,34783776,79385603,81172377,102273066,37668752,106685845,79576603,76532880,16284314,43573155],
[4244276,86115756,65719671,114157487,47238078,131518373,113442881,106993062,16457289,29565998,97202538,78729439,26399381,92286262,55305212,123231662],
[107359978,71397717,24354385,90905371,100671934,112972642,1300250,30373098,109432815,92024824,127755070,57862647,55660891,117808511,129406389,3828446],
[240717,192502,35033,493247,64228,509008,1188,66552,516440,430641,272088,188693,359316,111418,319701,523862],
[203216498,158288158,158772150,199513995,158531560,100813170,125737930,196954559,121863668,87243588,201853382,220669027,95825382,64207024,256428374,143214985],
[255309141,200843015,254260753,261476604,176286180,3920932,50515929,237842003,213982893,1385221,263514104,99612365,246425001,215115548,132287781,114164236],
[143362325,125369159,24405681,157156603,108307570,242637760,82516005,206867944,52481313,253260320,97238997,94945915,163561343,45269983,193757129,211328002],
[153572417,65478971,117972482,84570966,123332858,144969870,108331102,219830434,123140137,199849638,264711820,79406470,228787359,238045949,64518290,202081566],
[136371198,108264041,236877942,136987272,183214664,174379440,181291508,51920696,176434873,212987123,110682085,133115438,185681587,53336805,21397896,159263004],
[184424748,207764062,228650671,92041332,51170328,147719251,86492470,63035647,195378824,260885994,66252750,35045643,162315404,217353485,81237430,42999420],
[219823714,106039210,236486982,245747878,180578799,213876724,213658297,145214760,64118879,40603159,229671229,83383653,261833922,121781347,18306809,71212633],
[151274389,197502944,20884968,78515915,165644767,239721035,98326660,54158352,146175564,29257025,62927676,129190837,68515174,154501048,81463797,32403311],
[232891020,181365176,67086235,213718684,101940140,134536684,98735704,88508841,115235536,108171757,129008781,119846829,64444833,172713730,118202179,54785626],
[243275883,251097169,239501772,217316259,246355105,262779409,161785741,114083652,204379401,66873111,113944109,244638990,91965982,225767856,230838046,190367776]],
[[106690526,119549962,96948780,53329188,36227982,77378142,81214774,132627011,7773477,6326284,4229917,10784241,92599176,26888243,93737618,26731039],
[39275029,118151500,127926508,102755180,82533533,95836473,43795833,83693050,89194082,4431366,66797335,75051986,52561932,96148484,130774973,94598057],
[109924774,3204980,129054966,97712296,29104526,11968535,13554037,127945636,71130457,127067945,78835194,123102031,95712054,56200709,64205156,127987563],
[32744111,56175635,36417286,69144032,7469806,35330158,16428712,44196241,86192629,98091808,96953099,100149196,89567365,86457500,51204519,47797892],
[119073368,104673808,92381041,120113493,120683859,72250904,27283234,38011324,61285942,29028190,114806662,47648269,84406262,100483153,79804795,62766594],
[61235180,95453859,119242777,117414508,24368764,82195900,32246111,2098936,19228626,9770555,96937018,20835970,57436678,8717655,112825172,70177031],
[122881176,39247517,86950525,69252950,83652666,70678850,12716397,113047028,55707164,89122048,118976168,90294938,65108102,31211133,55604878,9244395],
[111367248,119376374,10915580,73910496,38713024,42495678,14842639,108275722,41046334,60860039,36002918,133311176,52611726,42553602,125489745,56254348],
[70787328,18991513,32363227,56397323,52954698,24891616,34667114,122739602,48713715,133705711,72102463,115033573,4914022,70071701,7071063,41046371],
[88725281,62024679,126481253,64338713,33578176,84763793,11441718,41786814,123762812,76319352,72509840,13072657,7934359,46852974,61953053,107857914],
[12726569,119370717,98608319,52195027,22488907,75079454,90857868,111835394,55710310,109376675,15488785,109553881,11910736,104944865,129990184,2641079],
[110064939,131649032,123091180,131230830,100107629,20305606,129734862,29910843,120759826,96041551,16347171,128740632,64617444,66343585,59037810,8852230],
[26194333,27113341,19343792,29600563,41391386,91622240,29348711,19377041,80604044,129670725,103692754,102102644,29564592,132315001,74591890,96053953],
[1109318,45653792,9003514,36296755,12331185,59466270,16390510,114337497,96717290,39600982,49142118,4740977,85034797,93801250,96008485,128171008],
[111345940,38198234,3717181,106429144,122950343,118295439,26851529,118259821,93859559,22386568,102354684,116165421,132875684,48192370,78474394,32865823],
[60989516,9611403,79689294,15361694,97650274,77500241,127638165,27416287,54174308,55979194,131797171,61914243,24947198,63273679,21010812,9795147],
[124664503,40256432,76351897,41303163,103044397,66718841,69991986,115777163,57102871,81359978,115177628,67815877,56826494,32491082,4928845,65557219],
[115044512,9194301,46384284,25290509,122823928,129382955,27360469,9798999,10577551,87644933,52629880,112266080,33258589,129096487,35383823,89363193],
[114548385,10899502,48669736,11274693,77692340,9855599,23343651,92029699,130755640,89298839,25932239,115851951,125000235,18087644,123865413,50856311],
[76766502,133232763,36880047,115133444,87770104,48871969,69777897,1464665,4246345,42481452,18739556,98221221,56182709,104997392,90682494,133013298],
[68819181,86332154,106814807,116971123,51954507,116078519,30985631,125223898,90700439,63474462,58447593,51756223,72152888,35936138,69438074,68811471],
[130207728,45328607,77732409,125579819,126821310,25878729,47872086,87722991,99358894,81928342,60047574,9885928,102433940,78201020,38174995,97387776],
[127248767,18562804,45924083,14539960,65105311,103411608,47249393,85416420,83388320,116132122,72836602,33701286,44500259,50961821,17850568,11918385],
[20657208,83825194,77505326,83950605,99754999,116594856,94016781,68030863,8770659,15007098,37329804,90704897,60342679,88414492,123551730,60888780],
[51406151,88740364,26685439,93378097,2107542,103796202,3719699,22304642,25824564,121257377,122182395,27274171,93661881,73655960,65103193,102011540],
[86629011,111104179,36030417,77019341,91227643,115742674,122016208,13468605,38693757,716116,63098962,109550017,127739023,71914498,124339473,23548190],
[7423052,21489131,98570858,80692172,105964274,6560034,81592420,123981331,103258728,66233622,92808723,84275345,126592309,39236300,39622877,8049088],
[686145,129237742,118690595,118927665,91559090,113610039,109972719,44698768,112924540,45129676,124815419,24790897,58602668,14001224,20911833,72331494],
[64565086,58842386,113698879,37553989,43333672,48429998,123945305,25571829,4286118,87441635,47028985,131254428,96291795,91217589,116488747,66419761],
[125302,451400,261920,409617,247621,142015,228331,315700,405092,81913,455060,389079,512455,204893,426737,418965],
[257064044,57386359,48268926,192162103,208925030,248801519,105879243,216808798,123932112,77518476,81997425,96711441,236974672,183339735,135005820,46260683],
[117263861,259973984,223709891,166407759,488290,204789755,232980775,181225762,174076303,196342168,73207377,169554535,170813878,22869497,116979356,16402607],
[3923775,82436199,56545544,216492008,87903261,143288828,45459689,182131203,181976359,41890219,24825482,183508792,250857753,54468332,240239960,160113322],
[145043551,254792156,77787434,189053414,67103504,89981101,78125955,93819537,14930702,57864190,206673305,66035742,109693145,22566431,131222067,195362067],
[164531411,257029378,29785000,206885959,250678254,78172638,45430200,246376289,54489417,74632237,124350637,174488056,175704345,249547364,143918048,160927097],
[81782487,262724672,33419821,25965509,136873920,48933585,60181761,258725097,84970009,179520711,136768801,35226068,264228316,46060322,157934445,64456241],
[217148158,256775170,219202540,210632988,25035181,208523447,266139296,159979949,57011352,241912350,19062145,249794935,228738071,213830658,145936249,31164463],
[88785739,107153252,60413480,167879640,212138058,177836174,154236889,158740511,21185632,23645405,2442352,18725526,44884639,167092942,35035294,27663372],
[96197791,148645408,114477466,50196580,144344552,229205336,201513242,215176084,48410959,218895603,152141523,263583685,214004252,239852015,153455117,66868303],
[135364591,62632523,207174028,60525583,66981141,126172950,165327507,81338576,138434375,167029066,119116841,21772378,190991615,82364344,111799044,199112591]]]

original_moduli, extend_moduli = [134220257,134206049,134208961,134207329,134208257,134207681,134208769,134208097,134208577,134208161,134220193,134213857,134215009,134213921,134216801,134214529,134216737,134215553,134216609,134215841,134216129,134215681,134219713,134217089,134219681,134218433,134219009,134217409,134218081,524353], [268435361,268435009,268434977,268434721,268434401,268433761,268433569,268433441,268433377,268433057]



a_rot = [[[16941795,32700662,126167744,88606143,104616316,50569321,31059381,34152739,114783264,11743462,50762553,43138338,24181791,62587530,85791959,5672354],
[3844892,8620442,115001553,114640055,45312931,12221622,129474533,12796196,89253042,33531435,69274945,14556280,128458674,49580360,40577170,102074085],
[63495701,42747304,33614013,117299451,9053875,33475325,90350689,52065966,120079191,82197482,112260648,38989690,81345011,31950380,10100154,67692790],
[116153690,16169292,50764876,28371394,20821903,83113570,24132561,69160233,113306613,92449867,113652983,10193960,128144522,15500911,16104828,58845785],
[5103990,108601232,52061256,43989348,23046721,14526170,69434303,100046296,50987138,71691470,79140534,110170628,63001882,100243465,16584622,76659553],
[45069775,113337085,24817539,73639330,122139925,62459118,96321185,13909167,123067979,83158365,18063708,117570492,117527006,98060237,62513137,128697820],
[105728731,127242644,36374515,103458047,19491750,107049849,77608877,121169175,118001998,59905073,121867451,127959679,21446566,77887445,34168540,43318239],
[4538074,127914992,60572293,18434770,97268376,10557460,921595,122096260,2301582,104766080,1840590,58714383,38223073,79796745,111499933,66407713],
[83569384,2395435,38100127,118123541,45568567,63306463,76999066,56727405,106483492,8324782,90014399,110339200,68629920,107425379,13441588,32198283],
[58660829,83047121,123520669,127666212,37615768,51080465,15073741,25878565,94749755,129309344,113079610,101783978,48014340,53992383,12957331,129387770],
[79415835,127472313,17948985,11962978,20626592,11099715,14954609,31565201,10976893,21838782,53936689,95300422,18900168,127786958,10644699,87935077],
[121580400,85818260,134063016,48994707,79328947,122106599,122251428,92207094,25982673,78035178,48449170,6301976,100915547,34100543,16195844,90611988],
[39130923,16745871,91401406,52406694,16919125,47693392,6467761,97562213,36312559,42758050,30676197,57462541,95386506,9888461,43028855,119204492],
[8952369,128456621,107982794,132037994,93581291,107355421,128290849,64605757,129930134,119016228,291412,2805033,67372571,52680357,112866047,55695264],
[10919990,39250675,126641431,52662789,16704259,47286743,113895632,62554805,111185469,55815155,101725090,118314612,64145098,111070666,16768597,23042933],
[5576652,12212243,81738407,61317252,42787897,9531295,86591948,21004365,18593028,81066553,65803216,1862328,1714952,112420343,49531418,72847650],
[61628262,41560350,20034860,70771860,70529016,44350285,17674797,129992454,127779669,125069979,99467688,97006969,13459368,90868610,40494659,8126058],
[8023593,75087237,11727290,27968892,87435887,133240983,57583437,117716889,23427120,17373694,103806875,132181062,8192985,110089293,126811700,68219973],
[63433072,2009734,1754724,119877129,45359185,12343318,34482472,48440460,62105453,60352747,80545739,58057647,34336401,54283168,92302642,93048853],
[92802486,110820176,124559682,101853349,95860575,96179922,13712060,123590931,15914407,44024978,59605872,61416076,90386607,1887723,52952236,99830810],
[362657,52353307,128327694,128113618,18142521,77557275,49816498,2483950,35153439,73349981,39213623,64718468,16006770,10925225,68543729,84170781],
[134369,57080132,11070047,96715970,114604475,43358895,45342199,22986523,120358832,105395913,119043800,133154910,61926224,127791239,34555603,48645297],
[129340688,109857507,125844425,125825145,104006503,48184292,87551628,7444293,32551157,62338899,59631262,37049245,30207839,35101063,18625738,105783542],
[69285068,50346910,67094611,101174292,114602124,26291680,119157,113641180,70488962,9383311,38294660,74853836,110178405,112390023,76172450,55131652],
[20423683,31353617,15399313,2079432,46513966,132698433,132443082,132763592,95982933,8292771,78974968,197591,67098321,102831313,78587578,101285235],
[123294019,99013804,66166558,124453494,12775725,46364166,57263402,69380452,85216497,43300125,115101545,60053307,40779508,100784569,25308852,87182261],
[85829869,51204607,25079272,48325416,108503404,7063144,6079569,44186158,47292608,36167340,124273592,17555277,128342292,117214302,10899299,51529297],
[58759854,55975227,115342614,116360086,27069793,124409295,109772815,45172448,63555036,90601501,92951585,87811028,6516224,20255083,85369484,29371265],
[40784845,53812040,133842547,16416089,30007695,45953939,91452767,3304422,78667997,64739015,28277448,3095530,63112103,45819782,102655924,80537928],
[477701,380422,185760,275944,326044,480615,238921,332188,25967,475179,39885,246116,175429,508491,211324,509625],
[56208441,166653600,6862245,35278358,251566808,38103728,151141037,232847232,112809228,197777437,176555642,170951089,178550619,235817824,195149141,5694733],
[205933884,178019490,52691461,27183809,178649070,108899512,254830104,129547355,102166331,189873379,150640550,175471127,184729777,159340484,140581205,100670197],
[4441798,72155176,266063811,180443282,243327046,181896752,155552564,61641406,250017632,240000252,103390848,79939477,198833976,162634495,246925779,151079040],
[107311250,243554073,246759126,237647330,807223,221718921,158877372,217069413,193747778,179642041,196166805,184124757,215779620,129082652,196086736,110302215],
[35574373,122917748,74694618,220473514,174907452,96824792,129560987,238641534,61233260,114304454,57242592,63648500,207725558,167561420,225996045,136906996],
[188546597,157942755,140829705,242689164,241578238,111630607,64808090,149982491,87716668,122065386,242423231,35071775,67147188,20514873,43623799,116563024],
[184234449,192820911,180971203,65765778,66600095,50743773,36675951,200193578,248704964,191783503,91956763,143834820,222798338,159572235,247027829,24980115],
[220127,202124257,160325326,151069718,234893050,85374790,36105785,168024074,201271972,234972610,37967224,29046668,65958334,162446193,109868498,103647140],
[64571754,31465197,138732421,184358643,241206661,110693521,55173885,40818445,53072126,224880784,138967669,100213704,110347135,241745305,99016740,151639093],
[78826193,33415880,187229435,51969645,66089712,184750177,168508738,78779029,93206283,235763696,139583682,225575746,182621985,87208509,7554220,261677516]],
[[100991821,20176227,38434315,6848830,99042736,114152228,55720840,26004254,38912363,46238154,13484464,31620731,76409005,103698855,119299867,127131750],
[119607834,121432798,9922965,85815698,5805841,64115170,6868141,30040877,92949887,122654195,100433243,132662382,92591528,70114394,70721499,133067157],
[47329829,15791322,83424908,27404784,77780245,20347139,69047859,107666156,19844476,38100615,67055249,129951612,59502451,9564977,35532111,5466273],
[64533725,110569932,117991298,1564669,42791156,111356116,117128754,35949102,77025746,89404201,55355993,26672729,84280516,5458456,126736605,128161119],
[92897797,10819167,23425269,133375468,95434069,57118623,18207125,66474208,115296130,6644157,132556191,96180454,110127182,82202951,371910,81646216],
[207681,90121714,41652975,132901877,98601540,14702394,78581448,56829278,95753464,115460735,70237261,87297568,97630447,17274156,68174169,84308649],
[132510389,102959771,96390989,32096368,117569122,24324485,1321440,99575038,48895757,98274461,49826566,125510458,129231534,132271835,131061739,53403429],
[38132009,67129226,24076103,74228750,31522553,104046980,67417017,41623217,88959333,118517545,32579873,24360296,81214178,48715117,15085749,30309469],
[52636047,51639999,48400251,42712564,38052549,7392547,52142877,123075601,61620594,21983691,121366289,103309186,69631491,29091515,78678379,13780989],
[121990772,102573900,79453154,40397589,71045521,133789784,62431367,51524991,41585924,401530,59120161,118963342,63959693,2760104,85147316,80157202],
[54576776,45974535,18057799,93667687,126116545,32963727,39363357,58257857,66340749,65891790,87133992,80987331,121617792,59823842,12645094,39976129],
[709391,70939878,12813733,65225021,124973443,130958795,55550231,27527258,9198649,273756,50997041,101738556,78751920,93323566,115160842,53932172],
[129675143,78750522,111867330,66777134,45749211,2001711,16734719,129550334,122316705,106393826,82366536,16866994,25439997,125318963,124777470,14500078],
[116736475,80933186,33521398,44618809,117843098,2484901,23089929,56962157,13592326,38985779,133479734,76410953,110768885,13466958,56126632,126332292],
[107742270,27943113,82838964,39993980,15782873,60936780,48526542,81012682,46829,2160579,14902523,2385475,109490535,59563347,99275534,43910557],
[21442359,658743,71835488,10820287,109982662,118719572,120127686,106161212,1274941,80646888,13741684,81197905,36759315,68506247,122527425,127306981],
[74663194,113877949,74939403,16139401,100815069,32009932,92848982,59632476,51455180,3249218,84248370,133759221,53332251,115595243,3398446,21333900],
[38869231,79871647,12023168,97572265,56689693,75965892,41338720,17622504,120609112,32263834,40187098,99299074,132652265,50840392,34826562,114737803],
[86563532,85497995,56057736,21203245,42889996,89814081,60284765,125883020,122280944,41726286,544843,77944042,20821796,66442013,18769637,120615428],
[79456869,111286955,80004397,111107057,85928668,72915969,129589933,23069839,15032929,102322853,86160198,98426770,95712756,76319654,87732017,12963216],
[50291504,54082632,26328176,47141732,5875922,19792272,115247687,83452511,118530454,132736131,108371048,119904127,106538838,53622966,94294578,98604422],
[124576475,17098652,64840947,128687825,44191215,43752124,62835160,100709644,443633,415982,39673625,77747846,122959156,52307797,72642408,85995149],
[62984151,93511155,26311260,16099405,49797702,11640432,77097787,96983182,13802758,35506536,33982291,37493599,61285191,96134215,41684867,133281273],
[90496031,106658029,7687378,27001904,111933761,105862771,109275954,89089920,8351419,54567980,28867348,33636380,92728038,74173025,91606815,61536689],
[80212637,19431530,121320235,94989916,33450117,123838197,24034281,102457145,122452958,92142040,37692161,58794175,50310828,54615940,112184315,108377759],
[57797748,42225915,92746024,20809266,91191521,110190796,53685234,100406552,11639766,83575814,85373798,107081646,43288925,30548635,66559388,112915633],
[12784516,23567887,45060313,676235,38998626,59430216,102618910,34184944,125776096,117824052,47240841,92725355,77001371,100387873,21596800,17117134],
[16854083,114470,80493645,13825620,115696230,30748367,48235627,25495144,102313603,66914369,115033233,41424256,90896947,6103398,90405358,34849777],
[101652289,122596591,62037763,60764544,27369152,94982595,45099458,60264373,25539682,74407465,71292509,68644231,9248243,103862205,32745105,96252087],
[292771,404293,49072,445227,290208,161529,215175,480836,332163,260228,9744,364565,204513,482192,266618,362675],
[229077042,45188715,104870762,131465038,32860730,92385063,66347161,142471309,245434091,75036537,105857628,248350743,76707570,201157112,123483286,44571870],
[212684706,83517641,183012032,263798728,73009695,260082153,104104773,180856263,178724261,22300458,65411537,237234675,174695235,94822179,68219531,215725655],
[139802502,60009058,221884549,177775214,249016647,56724866,212551072,113836169,191195678,2441883,42811983,194808659,213331375,48813390,240702577,600229],
[51832823,255343745,172550883,110927546,113700094,207555454,112534415,192353578,257524349,107025136,255411373,114886040,98285149,34329507,230457840,93422337],
[48622248,145007939,119604744,165873693,41831517,211622505,184616708,250523072,184395277,41564560,251385047,120880123,16088701,92218438,196442787,205905795],
[193495975,237268055,108821772,62774561,166192080,215020717,167427950,139226839,98258329,14087093,196387411,25499931,247262000,100216332,204681273,144542084],
[164907127,117770827,113231261,31938948,129081055,252180904,169700951,44930013,203500858,117345866,174922866,256984086,267892475,143567461,58184871,183825794],
[124956467,63808044,129123393,11539339,219155505,252020852,117190021,90674985,109038723,225987841,177351128,116655456,223309237,123086930,258839756,107201500],
[181963345,31562171,99592950,165581136,202901389,261258192,165145551,106850222,139222444,14146665,268018305,138355287,199409190,154276282,54541221,38725101],
[155037099,94222670,252900414,163033268,156156129,160193327,76689920,234205876,188783712,265465319,71572561,186810219,168426695,248927099,255799944,21548024]],
[[39224469,38410592,12565677,65772159,131716076,52493138,101586702,83514195,27570989,92471730,122763399,101238079,129769947,48195185,127324077,56925334],
[91839842,129481934,114424305,3370104,127875802,96247639,61417399,132301892,125065918,25956081,115787383,26391062,48002475,111581900,31367677,87703120],
[106215101,75439425,76479493,64921546,132041335,91562440,132418330,103290278,86107819,87809945,104424561,90921598,50830222,33708892,103393427,90422219],
[80718032,5077961,102766452,87636709,51113452,87947191,69888579,88935790,78021465,30738961,112737140,98476323,40813412,3620483,102372945,9403210],
[27777993,50949665,18571639,75695866,14464127,66375235,6174468,57053576,29806531,6345585,2741810,111117105,129412060,33782365,23663584,80667022],
[12460635,97130662,101940703,83429095,96125905,126283712,26377291,13515858,28362101,17125204,42981785,56345684,18263337,16757239,25886946,88166704],
[108314184,24202541,94241096,23429591,101913102,78893414,22527259,88118266,10924280,96669296,47141613,71449731,2696796,2270328,97358064,20232504],
[7678822,3668270,78907140,43932179,21843601,39368078,89741428,78108317,15570421,79938353,54644360,64206423,36513012,84094544,4614855,55619558],
[38808827,104535668,134087598,90412819,14799420,110203577,93608784,73263192,64539638,65101134,121754966,3619159,6387084,51424457,57406306,70999227],
[48523357,70352913,110429059,97263651,121355231,104148111,55225393,108341820,115093972,47074006,117620363,83665345,16702514,32401654,19270465,132606261],
[28516914,88205064,13428242,104713334,101695350,93222231,11045871,34426488,31266655,118965287,32632374,4822830,28430210,46169398,103042606,116601840],
[16015192,102703206,30875190,128018843,5839404,124029533,31617553,90417316,63425233,106948133,64222607,26258459,94826890,37218938,17807648,92958653],
[61597907,85805207,59039814,64017213,53106030,90989719,11866611,99857197,64678042,61451967,110500812,26361683,102264705,6113295,19153245,20096707],
[1325359,125978594,128940220,25118999,86819875,121611679,123068232,115695427,109069759,100938573,34058884,16551496,132021350,80361826,78814505,69980230],
[89902570,74715557,39934547,98332591,65681003,71077643,102525313,89617106,8118570,45672706,59003297,90658558,117233024,86619552,10898736,14604746],
[98427043,16694740,56068008,98552179,19453586,29501461,92611662,101825748,95308022,119258744,54808846,76513726,91445516,104794623,52523192,73800424],
[129865461,47144827,11936625,36096658,82569372,8780554,79063817,5047967,123621982,6770342,20132733,70908296,71394740,95052533,93566513,7404260],
[64072804,83692486,63790338,34122361,73461992,128411972,105608794,251049,69303391,132873229,97645140,70561679,108767178,53212956,28497308,99513780],
[37901343,128880271,59136148,58176239,24111161,1468407,61194790,1745981,6033438,25099923,133865489,95573472,55477363,16972711,130378879,85740776],
[45670240,3461896,118974325,91479178,107566412,19139316,71809249,2507670,72880931,83217573,58290677,57102347,4683012,40302886,13705173,12631237],
[120648964,50799424,101037560,22092475,122970662,36342263,124380870,1724204,90335672,77086813,12135028,6928925,50844039,99954131,84976240,31518035],
[74377936,104371926,108584619,35393367,93018191,59537090,7363756,111427230,36391883,21767040,111523503,122466775,18896479,24501650,70562064,20783024],
[63632834,37047697,75407061,51449328,59952255,96648523,72428669,29664213,80392608,75707161,22220477,23516100,27039134,66317505,14999756,16718398],
[87156590,5209995,74053047,51058146,129535800,26153239,58959731,87029706,7207469,114397883,83107707,89153815,77000643,116964874,101637156,129613242],
[82189960,132736487,120301940,114281097,12474398,90180854,114384580,120794520,130778251,20102761,33397927,98449385,51618912,11536102,28185220,47085050],
[122058909,106099471,51376261,41657872,24429756,9262699,18315088,6685744,10515466,112845262,129026329,68885580,62690273,62828634,22742304,69924975],
[57902356,120907201,23955224,68998471,47962521,101230785,23751915,93579390,123515275,98377310,26527752,32414584,7713569,122340802,12749032,4060993],
[122882416,99789777,105979419,45330126,77277023,31259770,111540876,42346930,37833909,39794083,79576281,86583486,132917212,72373057,25515550,33904049],
[82691481,36254205,56468932,76592753,44577903,89527587,64221948,55963723,92221491,46469145,92888885,16428772,97544560,125444615,73191054,35450418],
[125484,150773,204860,280136,188179,126683,208088,127503,298766,273419,333791,2394,13417,84908,11579,109602],
[139722043,90477246,54031734,54118709,256018505,35640022,258420033,165245619,196494724,76738716,163937186,164752418,45499277,16898235,178121882,210637073],
[87035803,257103821,207568184,251922636,156557917,12226195,118933924,99161502,53323440,52208055,232080873,232277582,194067529,262105067,232818390,169943781],
[237987688,17285579,62356542,177901437,164784303,245446012,252133423,79632803,120648986,172148274,229621710,66233861,254557829,196454305,77191305,138898613],
[170607627,203656209,52904390,253701578,120264473,9579778,59962459,125508060,149506842,23414978,19795198,70632511,183426259,141218637,232201235,105114444],
[108440577,142248299,46530085,232475181,191817341,214251926,213938329,38544104,71948217,216636759,100028909,35292894,257113905,23689153,198141330,66412953],
[232780898,122289298,168083152,59529695,225469071,229770717,2027346,27442164,135324177,165201976,90405677,51141032,132731109,69196921,199474184,262337690],
[131750866,235575272,251804789,222860654,84610178,208420502,36225771,229862988,70986956,183218066,189064007,164666140,241946547,5163829,138680539,255956329],
[168580275,168226825,208467749,237713567,221993233,110204599,123662850,30703174,118451223,148558457,48097058,114752513,105324020,190032601,170032581,95494459],
[85861685,135977194,151862205,223941172,256929485,138688593,236954596,168167749,84549838,255408968,109284210,209432568,178659094,212230811,197726648,106966053],
[64488399,32846504,239436378,207324230,257050255,4943197,33073657,163677132,176090675,42774621,182479467,106577551,21226113,206673596,223898457,169051118]]]


e_rot=[[[66103129,82809950,86762249,95749550,76804535,128093014,29343003,51829130,29727454,35461875,47082387,17802025,95381654,43494869,20743594,32353413],
[99747124,100225099,27539189,79732337,107758833,122902702,83094165,2993570,129178847,112231162,61648262,81137086,57941804,83852985,117243173,74834184],
[115267207,58247762,56382300,6294441,29717817,29229233,7077105,40453353,69347257,95875307,31217889,21397675,58397253,676961,131836433,53835805],
[36218715,59484732,32288593,129518553,121670516,2267326,90229472,35890292,27032657,125191626,73398627,20250528,37897440,45860230,125502437,110956920],
[45297891,108022579,82117121,33061015,47788619,96029313,95080807,16166174,30772067,49635868,329114,81702188,60897946,24421966,106321411,61813752],
[6549401,65253662,78030567,17591604,26690888,131544579,132792728,9843404,124181218,100767442,59296893,103145722,67334896,110130837,42718553,131996767],
[85898131,69761389,15860867,134073382,15701223,77801987,93487785,79723181,47566915,121321004,6125000,90117467,98528251,21883477,89014334,26805791],
[62611481,108418697,56883281,76083805,27752111,34160090,22228778,20361522,104813606,83690861,78732839,81198875,129154675,41318902,129844882,16410403],
[46913397,68643596,26193593,5687547,30408774,43187373,65073723,14783917,77029527,63122203,100572644,104487876,90997896,84210545,30089990,88057470],
[78213981,102129983,102895126,14773604,85145047,134131247,32603356,93111246,125416200,12673706,4463832,124218170,49284068,105736177,111668183,31409555],
[99998826,85142499,48312760,27995221,83355284,81518686,126263501,19258742,65457341,52272272,103286448,84378124,112976635,55813860,106728421,55223149],
[107237419,104092797,19952402,80264834,51326257,105851739,50726250,57894429,71148516,61232162,54825816,114657685,95589565,58444729,29728805,10737483],
[56038410,79559521,97309921,71161995,61590574,53001238,42920524,46357065,3204474,104557919,102253183,125921456,55460982,103999542,122997016,81601293],
[51468218,118573694,109105099,88494297,4926362,46666843,47660102,79674877,69791742,25768146,27586272,129339057,79257046,33477893,19118415,8589416],
[19085572,7277355,31907850,74454738,96600067,87116449,77882227,127359280,10029634,30483879,131173158,109097043,46855038,76820787,128478607,19112756],
[82308599,7447451,62309724,25246031,50632618,49673729,89104100,103022823,99723374,100112035,61261610,74521402,7452201,79122983,78683201,103094383],
[72917002,35701587,91986820,85228435,101523213,34973682,18203137,27145758,101054854,66801020,87448490,33064882,126180151,104335919,96196135,125189580],
[71980589,67240024,76809344,65226833,68043193,73855332,93813297,53888891,53496744,73986458,98828463,36071587,54421355,13910279,4549493,33387021],
[29891444,71240820,35509988,13301003,108768300,59468316,106331729,61476030,52364422,55294882,96883047,93496206,72242792,126318942,31621563,59523420],
[76940691,17774874,37191464,39236385,22457339,1361112,94916480,73036059,49106916,55096933,63024495,7094482,46760083,27040554,96158951,98098260],
[121424348,76307295,23291777,1564804,34236037,131075532,94168201,826536,72756353,61086951,99767053,102241703,133549542,44516324,33808774,43107834],
[107657883,110306955,122012590,44311682,93885398,89842768,60392386,85501086,111698953,66067973,90125111,52971890,58714767,107332760,72136403,69198237],
[3833245,42029057,75998202,18797906,4386766,100509665,57145664,67559590,41912699,44978603,15627032,69104800,37710957,19316600,33344419,38843392],
[92895226,38463429,40317425,23475271,19855758,60814268,113328991,55668318,81425595,108333534,14914443,113555748,72342264,72058961,37405833,128881680],
[107453652,64195736,73415131,62302585,47014170,105694748,13689990,71547805,82688718,105074532,17064189,18137178,97447140,80804405,106103094,21124407],
[75516619,55022950,130181658,24636146,91757840,21358586,129440966,82509236,88453896,88857838,69543667,30265247,4339383,69485340,66371659,46006465],
[60215053,58317143,20115197,90294625,98069168,18296952,101506673,106844588,54268196,12484011,128195956,76405093,118397897,105824645,70458547,88277369],
[50685732,54517705,114193053,83690446,82276694,6689487,103194320,86365213,130254615,57860955,98031198,92263936,63949726,99122420,85658633,133419989],
[129803977,75427427,133711198,19916491,115229430,99863594,84552999,63827589,112587028,93588451,65699067,16874755,107345910,73763436,40248239,109741251],
[280437,183494,383649,488332,88320,446217,432010,28819,409868,69358,208076,68747,76540,478030,365445,187514],
[155746394,165354112,156445525,86839369,181879378,36633507,173376092,255550354,71223506,100829751,248537066,218573953,12514452,96598552,134517287,52863622],
[109229354,165316156,230128115,125307939,34686491,118560080,138068910,195105561,114303402,43949919,154915622,264068815,212899013,7925100,183304440,49711187],
[76835447,65917805,119480534,127055123,172628846,257164996,157278607,155776790,158665825,193899,37759029,189724440,202959306,46499550,236716651,142823000],
[187631667,157820005,259328775,217158988,130542163,231758970,215779687,162997463,73352508,244747169,258616014,158015838,198113379,203550835,243794483,9574019],
[125439085,47014468,197241332,46296479,4584720,6648644,245352793,196684310,83636587,238496874,104699131,267628436,259714494,233838038,249068215,109566035],
[96478792,212844784,130818274,109140064,253814209,81027580,195336050,180050685,173055309,36009738,95534018,112635801,112230886,240269386,206622558,180035747],
[220914263,209555952,205043855,251253862,126867456,30713503,157786724,95431074,95075915,142263189,2801216,69834672,106726066,158463842,39056162,235680833],
[102268732,17235205,236396943,223579032,198485439,125256110,30197897,25480865,199716594,77980648,11445996,222429445,156143930,134402643,164613214,221834867],
[128402118,60967893,205583343,131011281,181581505,90500202,56629980,167590709,203006595,146683513,257501130,222405074,238288412,87338413,172866929,65543328],
[110349968,25221288,49454844,194459757,146881032,89594028,216458542,151606963,53666296,182331361,118151937,172373591,159174312,97017153,85181925,27108434]],
[[15025645,30524818,84865908,788979,36171052,77691966,116024120,14697111,96283019,9071113,46772939,86239164,83930284,66131497,60422673,114901511],
[61446033,46748567,63337308,115895453,63767210,81294699,32786433,42492224,22679799,66496455,41874819,65775093,100521135,52875542,133115019,82542603],
[68158274,84658588,65993836,28151683,124121275,65874308,124378646,40221448,128588658,81256492,34394055,117037053,119050078,17317925,7824387,100853943],
[9313250,50021913,1004288,131368549,38849215,113716192,97319417,104990203,105324250,12198839,66162868,27654155,117685767,114065801,115667263,102523991],
[120219387,53617282,82363588,33708554,103082158,34009268,106546986,7708980,60382282,81116699,62445628,22023575,11620092,29649413,73757603,57206304],
[31246702,48232550,99898476,14304768,19794928,67655077,90693260,8906024,118586689,126534809,122669348,47300458,30682101,77590322,78563866,91002070],
[13675,121983707,115570793,105102415,108084503,28054961,3592808,87344186,2280424,109004576,12356004,71870965,94599262,77939611,14567440,121304822],
[11549905,14119679,98593438,72380470,102881622,54058546,42237832,4844313,35799185,80280688,125365778,24315021,108094194,96899242,54864242,13172524],
[133122737,76490265,111342911,90497673,71895375,79072633,32485388,20574794,93977257,25727072,19723001,77634782,74474333,63281676,41510231,61858488],
[9974666,80710150,80212390,17171811,52403024,18700390,5536019,102525723,83597340,103182007,116974412,22609475,97441862,47504669,68608584,32304605],
[128388774,33226556,32289329,40382544,24952573,59745799,40983535,75776623,7427927,31076424,126905584,122814253,72869985,130384668,131832560,14704410],
[30819465,56613121,39094478,103820659,1529129,112933630,56351351,32720796,119048703,41522114,44839941,4680124,102054855,83845029,58125797,51497807],
[14011343,80715144,130510353,125984719,71253389,4317553,62656587,57051216,127031098,21554085,11627866,35367709,50924387,107250230,24779302,14470082],
[123077354,32528156,54958378,101377988,45241959,15500365,132404434,73267093,22097595,43034270,132250202,92187199,27297763,86044661,113472798,113185074],
[40400119,1322034,79354912,124181269,58279632,124462854,116971730,41694815,57059459,77399614,38874639,27493597,112026129,123469864,3149998,47593743],
[75317966,92927575,60689593,118103475,33070413,72766206,117797546,122770890,12823743,90249597,93184574,32064498,101871716,17530946,17025901,15521593],
[75945552,57646701,124388399,8091352,115085407,52069261,22518177,59445630,86780429,120679106,113276178,99403735,121568988,43542474,76038923,31470321],
[18064966,44709215,107518779,113902110,87485984,97531981,52347425,93447029,51459369,108848178,117718710,1752141,85131207,109732695,14752996,103537192],
[6239859,19859105,49618727,38903532,96321272,87487666,91998942,73919201,89625093,128464643,39325438,77724697,25235939,53127023,112191948,83689787],
[4220398,29511145,38881848,37339743,83189012,13747039,20663547,98861942,124484553,8419606,123586381,75910335,125008365,63466425,44411884,47808664],
[55414424,37750974,68266823,54040661,96629308,57909919,128754112,11349586,66809377,12172657,81114016,113382463,40331989,126027226,69921101,53854396],
[85676501,24018761,117577319,83352860,53333893,104147687,77104994,22111827,29802272,115072525,75058503,8386766,131486198,109616634,43287115,127907274],
[69784051,69501503,117650799,56978544,32109581,106989941,73777676,65626348,74699550,113330234,83226095,127076484,44071242,29983393,105776110,37395866],
[58164665,88269053,87741549,109420719,90396942,40346345,4116989,44356293,3241499,12746176,103991944,113559036,98136541,12809514,127937047,78502400],
[24083619,81086808,34313779,74370186,100014685,66928507,36262636,72266918,99992853,35086714,12248955,15288053,107827327,26666745,103249056,49850926],
[92064479,104676817,95901140,78262440,115715981,65562457,40335226,54056874,30262904,59204941,74067673,104850430,52192084,45627408,66967066,128217977],
[85490463,122252340,99751187,70483922,32302080,93644091,122474120,39102393,95772420,116960279,117247770,85251570,64266345,123643608,27773948,45773554],
[98926393,116299135,59200331,23810801,114736917,70744525,86019411,41696063,79553915,40259821,127197303,33264253,77086264,61699343,63434696,114027510],
[27893117,61061019,115021049,60700247,86966142,56257117,16134153,6279998,107190413,81012963,17844382,106439107,98525107,33805713,28684621,35711419],
[405447,326935,452584,170511,148908,17986,317717,179374,19669,373095,109784,217519,447490,392147,480116,135542],
[164706707,102453045,194072588,66876827,153697274,29920464,145629108,170357674,228572830,11561958,170388024,117471607,102300758,6298199,75386250,139354214],
[62993319,268359152,132027480,223697341,57374900,191995113,120391636,92158580,264190378,120693536,186823391,80437510,58545522,68087656,106492248,113212310],
[32682753,186445699,191211248,78878217,3030060,62577345,94115961,226375899,262519482,204069668,93094609,174581829,149665431,241169269,126348220,20714126],
[39623712,210142540,26277290,249198816,46913975,208390335,254762425,233249813,128518141,230964202,209803340,31896052,200077405,54705051,257622988,33766404],
[44661107,152526823,38540957,64506772,79765749,155651889,261077650,166208986,143819264,30121937,34054722,175496308,36389339,173983813,96135036,226100455],
[139861961,11882138,244903216,2277744,37774392,21341053,250087201,35248452,140198882,251590001,60464397,62117346,164912482,149775495,26626837,11540969],
[216919003,257927511,203729743,32165582,188606693,88742488,93905473,185560553,88515425,73552823,198672297,225852851,58755984,199238458,68221845,235535392],
[173904483,134732326,202880464,26816941,53321826,226842259,175610830,207380301,155006718,208037657,203732632,37897803,250446670,105822852,4821654,248645553],
[88924554,63640650,22460417,140976107,184292807,117105029,152671669,141862188,168764481,195143359,266793391,180606733,136795070,221094872,54724348,11611341],
[110043295,123790070,35035407,151642606,126273276,97660620,187238746,182472463,86217069,196176594,205952269,30848224,40771805,163740554,522284,140646117]],
[[12644945,60848178,46240399,46453379,73515892,4412282,125670955,113352622,100906866,34082852,21880722,63058805,96598146,5975051,31922084,101978557],
[39990814,59784193,78941867,81047784,58102451,2682253,87153180,71009084,73814682,47780276,68412115,127870123,65943401,27492522,5370164,44047370],
[132391747,53645411,98255100,100250801,53740205,51436886,131505601,45054489,51819941,11142021,16916727,41010981,18891879,115069282,20569358,131971195],
[57456829,60401962,80464176,46400085,91333889,65514061,65565591,89200113,51848947,14417890,99754767,59194026,20981943,81807031,1595496,53514433],
[52331929,132866329,80504877,35449594,76753451,109583108,103746317,88651998,33611335,105447620,8522211,10516956,52040204,69006354,57236627,57397082],
[19805743,84007302,114163683,46533129,123426267,83994906,608046,20509100,10895195,65597267,113023106,118776805,112576704,38252336,36097716,85394079],
[70227578,51915546,71777847,7088817,121798559,21544831,95972530,28124511,112543070,127798956,6710757,22341830,51465391,96497239,133577885,54284741],
[92657742,104559422,27816070,22817402,20919758,66739473,19496916,43700504,83215580,22438559,8263946,3641426,70922051,5761636,1643128,76446808],
[119452972,18164380,42647253,122616060,52933863,32530910,121487043,50088154,77411790,38485802,20563402,9124735,8687104,33677756,22048264,35331910],
[77645054,50649062,107414272,25269550,14334185,96571057,34695384,59473428,52734685,4277137,13088364,127450211,86552594,48162359,55011437,86128284],
[7074888,56823011,113324294,20045841,51649213,14735492,112808714,92369402,46204649,103229301,119277618,130826544,27753841,21725026,118674533,37239113],
[91703403,74349806,40666288,35291589,24855599,87969819,76181011,34106140,2033178,23934620,107708142,45853030,101754433,100121574,83736774,9231529],
[36918172,77731166,78397478,53955272,1704753,107170205,56381258,9667227,47574995,21720023,46406669,112019865,43831196,56583166,29390819,25837726],
[107398452,13190507,38453138,99942676,20528695,58524491,40639264,106964594,130497145,44335316,115272140,20094007,35083578,84068940,134036234,24682127],
[36250728,106112888,40943440,11568700,46542211,128879601,85431988,46521137,112493516,75163618,124304006,51747896,81896374,85020512,122061010,53013520],
[16690455,60307277,132804791,57069632,68005083,90225114,75782714,80715056,91642191,131773525,62548185,70380745,23353039,8692468,47517528,56208365],
[63709546,16171430,19641459,50353943,104454850,4443204,77065348,23457461,48369761,4350478,54198760,86310317,87345223,94866749,132191054,72587512],
[46262480,57157295,125316105,124618301,89057488,97766067,62588243,90386755,108068796,22259269,60688572,6046990,123020320,9980389,91286528,93436315],
[42127915,67008652,13727738,118382734,103155695,112925930,114481458,88453236,6508721,120056579,35324149,90177245,62521956,31720782,3824349,63335669],
[94619578,20079327,107202399,47332055,75770393,28259800,97658484,47691439,31888826,29774428,68741265,22862856,25857226,13036150,117228482,111508115],
[21795602,77949564,105477349,58036770,103510400,99569322,6285998,10742061,118469834,32799629,72182663,93304577,127962005,64292373,15822599,65528222],
[80340661,15113592,133032085,104480742,133680119,132084029,55547272,77722109,131911307,38895023,43640736,57597778,49158309,70837219,109459015,108656750],
[19458225,8932293,100555560,104655312,33278414,56554657,16539671,39544444,48484052,79053498,27343191,101861180,39449119,40282330,82011330,7314938],
[72125042,16321960,63015429,79428229,27200688,47009109,72506567,131149698,19416697,1312635,84134520,19921321,108436627,107799838,4590978,85150221],
[49878229,85829955,86517174,126335064,77571466,12107921,120627204,17128188,68352588,33109267,122335780,85646278,94032519,111829287,63749101,52927044],
[22380305,5907118,36812885,70205631,124087794,25380778,79994549,123071138,101014233,116056140,89103891,12383610,76552182,59521431,70381626,60894089],
[9948580,33977089,22837906,25280191,10005962,10920337,61024802,83254221,68783030,101862533,118725415,82299704,118671880,51789347,95037951,45114051],
[13506967,95024884,42063711,68596350,64863750,11275613,62852534,59378857,62067420,42528885,21191004,78494132,9781416,82189568,110538620,115168088],
[19313367,125510993,85236132,42552226,14604932,31102967,116008069,23642723,89387314,21239579,128952994,111933714,127476743,67779088,71171107,132050717],
[340521,193295,434078,521732,486843,86181,488536,439000,240336,508075,482625,414490,501812,398602,323984,432062],
[138715660,51375768,105020456,57103920,248155561,26757770,73884936,12236466,35760416,253712501,243829453,179404309,93238955,188851159,66500175,104499958],
[142708012,107464003,228694643,266740099,137082064,243192454,7097915,91275784,167170866,47072068,4797442,107616402,113964954,177749036,227509481,77344785],
[194730244,81791196,161714172,138973732,21955870,149259196,34534722,162370269,235943152,133861072,241019963,94795632,92980405,94145736,96741409,212662982],
[4048798,136129267,235969383,33169901,105490075,77048797,11871327,54347185,168253884,162967170,262849953,230910461,230086640,199339609,231995185,3000069],
[258591857,128975860,9796577,65421593,24359070,25756297,246515761,92725215,37440855,19445993,219223247,139836733,40290964,93323107,250531834,226805780],
[99151150,195331286,48074482,25167182,69162661,116662614,160026287,236309098,78251243,145509165,105763595,162050349,64923,236219393,252440581,217286015],
[6781958,260577398,142864633,175040966,51699897,130898920,4996965,151651909,50486084,158954486,139647827,116964587,200443418,165015241,197549038,193895161],
[239030412,108210172,115453584,219247179,81493736,9583384,13575290,5784425,67848117,14875201,55618029,19655227,208989191,23671228,23960693,135171273],
[205186357,135174607,215549950,100983160,41042491,207351772,73590404,39687938,232856581,243037815,256649200,247950652,83649897,87013143,193613810,52562552],
[138488835,28982192,92055398,50040726,50846368,208253686,112668441,4812003,4642475,17753835,245017656,161304675,12397735,205250134,244026737,34057382]]]

sk_rot=[[128127957,88705825,104918620,18961530,2136998,48681629,80565711,91653930,28842020,61978974,9525636,79275873,20881951,63989295,33832365,77463485],
[33779909,3786373,42930287,21543435,71209244,111396390,125361965,21666813,111692671,99768243,38016856,91918063,52577410,21543525,129600591,96856617],
[68725812,53184571,11978810,19361600,105196317,83732656,98407885,31525979,38596357,49292497,20784164,109299989,99878001,121708676,70282424,91715950],
[92077306,84563503,58049772,62505585,55287362,132931186,129175090,46693130,64629060,131746182,19280425,91294210,22715458,34235508,67083728,115598456],
[131502776,44097749,1042252,50771077,93674838,110723274,5732301,94865586,117902783,67013003,8759143,38162100,48403865,27365727,64768270,34673055],
[100067144,63250075,73459945,60569596,29603165,96376949,99195011,36200097,92961815,16605084,101358134,64530469,78352862,109852039,114093014,71393730],
[103346305,33278956,107764732,41460622,55299798,74618976,27813623,60340092,50018370,54068849,16150060,64316539,134199890,119767897,79832240,51393203],
[112829087,99271606,18549943,20137745,73437669,10601492,51077982,18677253,83421073,110614460,77330223,111672236,92154055,10288754,2811367,46581734],
[10166482,5016942,111836613,57889442,58789037,109086862,125567932,114042107,104177880,21057172,73925254,64396641,22148379,89850156,66658837,39058880],
[29433687,67067624,20908410,62445537,75400311,54155942,121083394,7519888,73233836,108656098,50319650,46463525,98309574,45015084,37992438,41452129],
[97710605,16767634,100224175,67158098,24374716,17434175,88681586,91444629,39639929,93317585,76626423,105361729,84958118,134207301,57973984,112101050],
[63306898,133809198,109910865,22336411,82982302,61833953,103224870,62423730,124838567,20770617,40927417,39853972,92783133,42169792,98770685,107982303],
[61085482,10951362,76376831,84128027,41126464,87362391,14102194,17872008,105916852,2079685,80216954,53968479,98928777,15128283,114705500,75555774],
[127969223,63970613,119486424,86629346,7344406,25514616,69782342,128872592,96014573,33677129,116399360,59250666,22755306,117478391,92454154,40326148],
[127747611,123405401,124009277,80555244,9197244,10162689,67461312,78745066,96135675,48098997,52561197,40288223,110076110,127076111,60762472,51668580],
[125319959,38920027,25815112,110367809,37401081,76936710,36088000,63638399,88559388,69314049,100032981,64887508,20093327,93746893,60935027,61659962],
[14033024,2223562,75065375,23960768,15438405,110283261,25359999,23745549,125670219,115560456,10115561,110693498,14992739,48442713,123612089,100319941],
[14913673,40004149,72531184,41579499,23121340,92278636,8721463,31351438,107069572,54987449,6743123,78373638,133656476,4058605,97609568,132509058],
[23526907,90776522,40614245,60889970,133965117,54494712,1323594,69576892,80804945,24085581,115087018,57528577,89288983,50092281,108077719,73599809],
[133553357,119733426,126385255,71018531,80486262,108626400,124775781,116948883,86224841,119804379,22534383,11678276,47536804,92863237,118580310,95624126],
[58933155,40152408,113774500,23414237,33368240,36995830,131717253,125257602,123585543,91329131,13031070,115795976,44945479,122160944,89558194,43925599],
[118901510,30966126,78003632,59404151,62429674,125844824,132562331,32505039,81825424,90228793,92134613,53547707,21259676,56119902,11308445,26683601],
[122235787,115463394,98413819,15508589,84832927,32139328,35969033,110996097,100031846,77568160,48655080,46686381,47734156,89896086,37732080,9894941],
[84556462,8883312,95589192,130053956,7422901,99919093,70773153,53726088,130412730,5822641,81356473,87435277,17828077,2580532,49695934,13463802],
[91759184,101431158,38836427,53641367,118141325,94607636,75665160,10348053,84620821,55259948,121076107,111379355,92458551,75956831,122399390,94615497],
[71921362,128631401,96917463,75938505,64981932,73306753,43043667,6649400,92945968,37629533,131050416,87266063,9796836,92921645,32627138,28119382],
[65990235,30652380,109046696,96074658,111019472,134203285,35967067,93735701,6656847,87900749,110646968,90964956,46410983,122442564,19775138,46483382],
[108679072,69400142,87426135,110275487,51851037,59327464,35718440,73845328,19977357,89686799,31849538,40396264,6235291,46161112,23305244,85387153],
[81890572,30120246,83841334,102381724,63385240,63302587,131611903,86898200,9275692,79314797,56660268,46423637,96021646,63542428,130454256,82838199],
[484592,87462,481471,28689,214662,342451,213877,322158,303114,407386,334002,484115,305292,290600,67283,352023]]


ek_ref_a_rot=[[[16941795,32700662,126167744,88606143,104616316,50569321,31059381,34152739,114783264,11743462,50762553,43138338,24181791,62587530,85791959,5672354],
[3844892,8620442,115001553,114640055,45312931,12221622,129474533,12796196,89253042,33531435,69274945,14556280,128458674,49580360,40577170,102074085],
[63495701,42747304,33614013,117299451,9053875,33475325,90350689,52065966,120079191,82197482,112260648,38989690,81345011,31950380,10100154,67692790],
[116153690,16169292,50764876,28371394,20821903,83113570,24132561,69160233,113306613,92449867,113652983,10193960,128144522,15500911,16104828,58845785],
[5103990,108601232,52061256,43989348,23046721,14526170,69434303,100046296,50987138,71691470,79140534,110170628,63001882,100243465,16584622,76659553],
[45069775,113337085,24817539,73639330,122139925,62459118,96321185,13909167,123067979,83158365,18063708,117570492,117527006,98060237,62513137,128697820],
[105728731,127242644,36374515,103458047,19491750,107049849,77608877,121169175,118001998,59905073,121867451,127959679,21446566,77887445,34168540,43318239],
[4538074,127914992,60572293,18434770,97268376,10557460,921595,122096260,2301582,104766080,1840590,58714383,38223073,79796745,111499933,66407713],
[83569384,2395435,38100127,118123541,45568567,63306463,76999066,56727405,106483492,8324782,90014399,110339200,68629920,107425379,13441588,32198283],
[58660829,83047121,123520669,127666212,37615768,51080465,15073741,25878565,94749755,129309344,113079610,101783978,48014340,53992383,12957331,129387770],
[79415835,127472313,17948985,11962978,20626592,11099715,14954609,31565201,10976893,21838782,53936689,95300422,18900168,127786958,10644699,87935077],
[121580400,85818260,134063016,48994707,79328947,122106599,122251428,92207094,25982673,78035178,48449170,6301976,100915547,34100543,16195844,90611988],
[39130923,16745871,91401406,52406694,16919125,47693392,6467761,97562213,36312559,42758050,30676197,57462541,95386506,9888461,43028855,119204492],
[8952369,128456621,107982794,132037994,93581291,107355421,128290849,64605757,129930134,119016228,291412,2805033,67372571,52680357,112866047,55695264],
[10919990,39250675,126641431,52662789,16704259,47286743,113895632,62554805,111185469,55815155,101725090,118314612,64145098,111070666,16768597,23042933],
[5576652,12212243,81738407,61317252,42787897,9531295,86591948,21004365,18593028,81066553,65803216,1862328,1714952,112420343,49531418,72847650],
[61628262,41560350,20034860,70771860,70529016,44350285,17674797,129992454,127779669,125069979,99467688,97006969,13459368,90868610,40494659,8126058],
[8023593,75087237,11727290,27968892,87435887,133240983,57583437,117716889,23427120,17373694,103806875,132181062,8192985,110089293,126811700,68219973],
[63433072,2009734,1754724,119877129,45359185,12343318,34482472,48440460,62105453,60352747,80545739,58057647,34336401,54283168,92302642,93048853],
[92802486,110820176,124559682,101853349,95860575,96179922,13712060,123590931,15914407,44024978,59605872,61416076,90386607,1887723,52952236,99830810],
[362657,52353307,128327694,128113618,18142521,77557275,49816498,2483950,35153439,73349981,39213623,64718468,16006770,10925225,68543729,84170781],
[134369,57080132,11070047,96715970,114604475,43358895,45342199,22986523,120358832,105395913,119043800,133154910,61926224,127791239,34555603,48645297],
[129340688,109857507,125844425,125825145,104006503,48184292,87551628,7444293,32551157,62338899,59631262,37049245,30207839,35101063,18625738,105783542],
[69285068,50346910,67094611,101174292,114602124,26291680,119157,113641180,70488962,9383311,38294660,74853836,110178405,112390023,76172450,55131652],
[20423683,31353617,15399313,2079432,46513966,132698433,132443082,132763592,95982933,8292771,78974968,197591,67098321,102831313,78587578,101285235],
[123294019,99013804,66166558,124453494,12775725,46364166,57263402,69380452,85216497,43300125,115101545,60053307,40779508,100784569,25308852,87182261],
[85829869,51204607,25079272,48325416,108503404,7063144,6079569,44186158,47292608,36167340,124273592,17555277,128342292,117214302,10899299,51529297],
[58759854,55975227,115342614,116360086,27069793,124409295,109772815,45172448,63555036,90601501,92951585,87811028,6516224,20255083,85369484,29371265],
[40784845,53812040,133842547,16416089,30007695,45953939,91452767,3304422,78667997,64739015,28277448,3095530,63112103,45819782,102655924,80537928],
[477701,380422,185760,275944,326044,480615,238921,332188,25967,475179,39885,246116,175429,508491,211324,509625],
[56208441,166653600,6862245,35278358,251566808,38103728,151141037,232847232,112809228,197777437,176555642,170951089,178550619,235817824,195149141,5694733],
[205933884,178019490,52691461,27183809,178649070,108899512,254830104,129547355,102166331,189873379,150640550,175471127,184729777,159340484,140581205,100670197],
[4441798,72155176,266063811,180443282,243327046,181896752,155552564,61641406,250017632,240000252,103390848,79939477,198833976,162634495,246925779,151079040],
[107311250,243554073,246759126,237647330,807223,221718921,158877372,217069413,193747778,179642041,196166805,184124757,215779620,129082652,196086736,110302215],
[35574373,122917748,74694618,220473514,174907452,96824792,129560987,238641534,61233260,114304454,57242592,63648500,207725558,167561420,225996045,136906996],
[188546597,157942755,140829705,242689164,241578238,111630607,64808090,149982491,87716668,122065386,242423231,35071775,67147188,20514873,43623799,116563024],
[184234449,192820911,180971203,65765778,66600095,50743773,36675951,200193578,248704964,191783503,91956763,143834820,222798338,159572235,247027829,24980115],
[220127,202124257,160325326,151069718,234893050,85374790,36105785,168024074,201271972,234972610,37967224,29046668,65958334,162446193,109868498,103647140],
[64571754,31465197,138732421,184358643,241206661,110693521,55173885,40818445,53072126,224880784,138967669,100213704,110347135,241745305,99016740,151639093],
[78826193,33415880,187229435,51969645,66089712,184750177,168508738,78779029,93206283,235763696,139583682,225575746,182621985,87208509,7554220,261677516]],
[[100991821,20176227,38434315,6848830,99042736,114152228,55720840,26004254,38912363,46238154,13484464,31620731,76409005,103698855,119299867,127131750],
[119607834,121432798,9922965,85815698,5805841,64115170,6868141,30040877,92949887,122654195,100433243,132662382,92591528,70114394,70721499,133067157],
[47329829,15791322,83424908,27404784,77780245,20347139,69047859,107666156,19844476,38100615,67055249,129951612,59502451,9564977,35532111,5466273],
[64533725,110569932,117991298,1564669,42791156,111356116,117128754,35949102,77025746,89404201,55355993,26672729,84280516,5458456,126736605,128161119],
[92897797,10819167,23425269,133375468,95434069,57118623,18207125,66474208,115296130,6644157,132556191,96180454,110127182,82202951,371910,81646216],
[207681,90121714,41652975,132901877,98601540,14702394,78581448,56829278,95753464,115460735,70237261,87297568,97630447,17274156,68174169,84308649],
[132510389,102959771,96390989,32096368,117569122,24324485,1321440,99575038,48895757,98274461,49826566,125510458,129231534,132271835,131061739,53403429],
[38132009,67129226,24076103,74228750,31522553,104046980,67417017,41623217,88959333,118517545,32579873,24360296,81214178,48715117,15085749,30309469],
[52636047,51639999,48400251,42712564,38052549,7392547,52142877,123075601,61620594,21983691,121366289,103309186,69631491,29091515,78678379,13780989],
[121990772,102573900,79453154,40397589,71045521,133789784,62431367,51524991,41585924,401530,59120161,118963342,63959693,2760104,85147316,80157202],
[54576776,45974535,18057799,93667687,126116545,32963727,39363357,58257857,66340749,65891790,87133992,80987331,121617792,59823842,12645094,39976129],
[709391,70939878,12813733,65225021,124973443,130958795,55550231,27527258,9198649,273756,50997041,101738556,78751920,93323566,115160842,53932172],
[129675143,78750522,111867330,66777134,45749211,2001711,16734719,129550334,122316705,106393826,82366536,16866994,25439997,125318963,124777470,14500078],
[116736475,80933186,33521398,44618809,117843098,2484901,23089929,56962157,13592326,38985779,133479734,76410953,110768885,13466958,56126632,126332292],
[107742270,27943113,82838964,39993980,15782873,60936780,48526542,81012682,46829,2160579,14902523,2385475,109490535,59563347,99275534,43910557],
[21442359,658743,71835488,10820287,109982662,118719572,120127686,106161212,1274941,80646888,13741684,81197905,36759315,68506247,122527425,127306981],
[74663194,113877949,74939403,16139401,100815069,32009932,92848982,59632476,51455180,3249218,84248370,133759221,53332251,115595243,3398446,21333900],
[38869231,79871647,12023168,97572265,56689693,75965892,41338720,17622504,120609112,32263834,40187098,99299074,132652265,50840392,34826562,114737803],
[86563532,85497995,56057736,21203245,42889996,89814081,60284765,125883020,122280944,41726286,544843,77944042,20821796,66442013,18769637,120615428],
[79456869,111286955,80004397,111107057,85928668,72915969,129589933,23069839,15032929,102322853,86160198,98426770,95712756,76319654,87732017,12963216],
[50291504,54082632,26328176,47141732,5875922,19792272,115247687,83452511,118530454,132736131,108371048,119904127,106538838,53622966,94294578,98604422],
[124576475,17098652,64840947,128687825,44191215,43752124,62835160,100709644,443633,415982,39673625,77747846,122959156,52307797,72642408,85995149],
[62984151,93511155,26311260,16099405,49797702,11640432,77097787,96983182,13802758,35506536,33982291,37493599,61285191,96134215,41684867,133281273],
[90496031,106658029,7687378,27001904,111933761,105862771,109275954,89089920,8351419,54567980,28867348,33636380,92728038,74173025,91606815,61536689],
[80212637,19431530,121320235,94989916,33450117,123838197,24034281,102457145,122452958,92142040,37692161,58794175,50310828,54615940,112184315,108377759],
[57797748,42225915,92746024,20809266,91191521,110190796,53685234,100406552,11639766,83575814,85373798,107081646,43288925,30548635,66559388,112915633],
[12784516,23567887,45060313,676235,38998626,59430216,102618910,34184944,125776096,117824052,47240841,92725355,77001371,100387873,21596800,17117134],
[16854083,114470,80493645,13825620,115696230,30748367,48235627,25495144,102313603,66914369,115033233,41424256,90896947,6103398,90405358,34849777],
[101652289,122596591,62037763,60764544,27369152,94982595,45099458,60264373,25539682,74407465,71292509,68644231,9248243,103862205,32745105,96252087],
[292771,404293,49072,445227,290208,161529,215175,480836,332163,260228,9744,364565,204513,482192,266618,362675],
[229077042,45188715,104870762,131465038,32860730,92385063,66347161,142471309,245434091,75036537,105857628,248350743,76707570,201157112,123483286,44571870],
[212684706,83517641,183012032,263798728,73009695,260082153,104104773,180856263,178724261,22300458,65411537,237234675,174695235,94822179,68219531,215725655],
[139802502,60009058,221884549,177775214,249016647,56724866,212551072,113836169,191195678,2441883,42811983,194808659,213331375,48813390,240702577,600229],
[51832823,255343745,172550883,110927546,113700094,207555454,112534415,192353578,257524349,107025136,255411373,114886040,98285149,34329507,230457840,93422337],
[48622248,145007939,119604744,165873693,41831517,211622505,184616708,250523072,184395277,41564560,251385047,120880123,16088701,92218438,196442787,205905795],
[193495975,237268055,108821772,62774561,166192080,215020717,167427950,139226839,98258329,14087093,196387411,25499931,247262000,100216332,204681273,144542084],
[164907127,117770827,113231261,31938948,129081055,252180904,169700951,44930013,203500858,117345866,174922866,256984086,267892475,143567461,58184871,183825794],
[124956467,63808044,129123393,11539339,219155505,252020852,117190021,90674985,109038723,225987841,177351128,116655456,223309237,123086930,258839756,107201500],
[181963345,31562171,99592950,165581136,202901389,261258192,165145551,106850222,139222444,14146665,268018305,138355287,199409190,154276282,54541221,38725101],
[155037099,94222670,252900414,163033268,156156129,160193327,76689920,234205876,188783712,265465319,71572561,186810219,168426695,248927099,255799944,21548024]],
[[39224469,38410592,12565677,65772159,131716076,52493138,101586702,83514195,27570989,92471730,122763399,101238079,129769947,48195185,127324077,56925334],
[91839842,129481934,114424305,3370104,127875802,96247639,61417399,132301892,125065918,25956081,115787383,26391062,48002475,111581900,31367677,87703120],
[106215101,75439425,76479493,64921546,132041335,91562440,132418330,103290278,86107819,87809945,104424561,90921598,50830222,33708892,103393427,90422219],
[80718032,5077961,102766452,87636709,51113452,87947191,69888579,88935790,78021465,30738961,112737140,98476323,40813412,3620483,102372945,9403210],
[27777993,50949665,18571639,75695866,14464127,66375235,6174468,57053576,29806531,6345585,2741810,111117105,129412060,33782365,23663584,80667022],
[12460635,97130662,101940703,83429095,96125905,126283712,26377291,13515858,28362101,17125204,42981785,56345684,18263337,16757239,25886946,88166704],
[108314184,24202541,94241096,23429591,101913102,78893414,22527259,88118266,10924280,96669296,47141613,71449731,2696796,2270328,97358064,20232504],
[7678822,3668270,78907140,43932179,21843601,39368078,89741428,78108317,15570421,79938353,54644360,64206423,36513012,84094544,4614855,55619558],
[38808827,104535668,134087598,90412819,14799420,110203577,93608784,73263192,64539638,65101134,121754966,3619159,6387084,51424457,57406306,70999227],
[48523357,70352913,110429059,97263651,121355231,104148111,55225393,108341820,115093972,47074006,117620363,83665345,16702514,32401654,19270465,132606261],
[28516914,88205064,13428242,104713334,101695350,93222231,11045871,34426488,31266655,118965287,32632374,4822830,28430210,46169398,103042606,116601840],
[16015192,102703206,30875190,128018843,5839404,124029533,31617553,90417316,63425233,106948133,64222607,26258459,94826890,37218938,17807648,92958653],
[61597907,85805207,59039814,64017213,53106030,90989719,11866611,99857197,64678042,61451967,110500812,26361683,102264705,6113295,19153245,20096707],
[1325359,125978594,128940220,25118999,86819875,121611679,123068232,115695427,109069759,100938573,34058884,16551496,132021350,80361826,78814505,69980230],
[89902570,74715557,39934547,98332591,65681003,71077643,102525313,89617106,8118570,45672706,59003297,90658558,117233024,86619552,10898736,14604746],
[98427043,16694740,56068008,98552179,19453586,29501461,92611662,101825748,95308022,119258744,54808846,76513726,91445516,104794623,52523192,73800424],
[129865461,47144827,11936625,36096658,82569372,8780554,79063817,5047967,123621982,6770342,20132733,70908296,71394740,95052533,93566513,7404260],
[64072804,83692486,63790338,34122361,73461992,128411972,105608794,251049,69303391,132873229,97645140,70561679,108767178,53212956,28497308,99513780],
[37901343,128880271,59136148,58176239,24111161,1468407,61194790,1745981,6033438,25099923,133865489,95573472,55477363,16972711,130378879,85740776],
[45670240,3461896,118974325,91479178,107566412,19139316,71809249,2507670,72880931,83217573,58290677,57102347,4683012,40302886,13705173,12631237],
[120648964,50799424,101037560,22092475,122970662,36342263,124380870,1724204,90335672,77086813,12135028,6928925,50844039,99954131,84976240,31518035],
[74377936,104371926,108584619,35393367,93018191,59537090,7363756,111427230,36391883,21767040,111523503,122466775,18896479,24501650,70562064,20783024],
[63632834,37047697,75407061,51449328,59952255,96648523,72428669,29664213,80392608,75707161,22220477,23516100,27039134,66317505,14999756,16718398],
[87156590,5209995,74053047,51058146,129535800,26153239,58959731,87029706,7207469,114397883,83107707,89153815,77000643,116964874,101637156,129613242],
[82189960,132736487,120301940,114281097,12474398,90180854,114384580,120794520,130778251,20102761,33397927,98449385,51618912,11536102,28185220,47085050],
[122058909,106099471,51376261,41657872,24429756,9262699,18315088,6685744,10515466,112845262,129026329,68885580,62690273,62828634,22742304,69924975],
[57902356,120907201,23955224,68998471,47962521,101230785,23751915,93579390,123515275,98377310,26527752,32414584,7713569,122340802,12749032,4060993],
[122882416,99789777,105979419,45330126,77277023,31259770,111540876,42346930,37833909,39794083,79576281,86583486,132917212,72373057,25515550,33904049],
[82691481,36254205,56468932,76592753,44577903,89527587,64221948,55963723,92221491,46469145,92888885,16428772,97544560,125444615,73191054,35450418],
[125484,150773,204860,280136,188179,126683,208088,127503,298766,273419,333791,2394,13417,84908,11579,109602],
[139722043,90477246,54031734,54118709,256018505,35640022,258420033,165245619,196494724,76738716,163937186,164752418,45499277,16898235,178121882,210637073],
[87035803,257103821,207568184,251922636,156557917,12226195,118933924,99161502,53323440,52208055,232080873,232277582,194067529,262105067,232818390,169943781],
[237987688,17285579,62356542,177901437,164784303,245446012,252133423,79632803,120648986,172148274,229621710,66233861,254557829,196454305,77191305,138898613],
[170607627,203656209,52904390,253701578,120264473,9579778,59962459,125508060,149506842,23414978,19795198,70632511,183426259,141218637,232201235,105114444],
[108440577,142248299,46530085,232475181,191817341,214251926,213938329,38544104,71948217,216636759,100028909,35292894,257113905,23689153,198141330,66412953],
[232780898,122289298,168083152,59529695,225469071,229770717,2027346,27442164,135324177,165201976,90405677,51141032,132731109,69196921,199474184,262337690],
[131750866,235575272,251804789,222860654,84610178,208420502,36225771,229862988,70986956,183218066,189064007,164666140,241946547,5163829,138680539,255956329],
[168580275,168226825,208467749,237713567,221993233,110204599,123662850,30703174,118451223,148558457,48097058,114752513,105324020,190032601,170032581,95494459],
[85861685,135977194,151862205,223941172,256929485,138688593,236954596,168167749,84549838,255408968,109284210,209432568,178659094,212230811,197726648,106966053],
[64488399,32846504,239436378,207324230,257050255,4943197,33073657,163677132,176090675,42774621,182479467,106577551,21226113,206673596,223898457,169051118]]]

ek_ref_b_rot=[[[117811825,18603986,69476163,118475427,56752779,69674230,108994464,119694226,52965032,80782892,101996350,109869111,26423917,3896486,71106489,47419225],
[106228155,51120292,27295518,49410373,57082794,125736271,29261615,130861987,82231632,111466408,16745411,118407114,45812660,109334864,36425689,43798068],
[47737487,114415121,12420273,74976767,121886952,99876059,49977768,41945113,88035632,81362022,19457825,59980584,54264082,71722032,122197748,130285662],
[26434257,128181165,110674629,10262747,285040,89512930,36149688,56533697,94381952,52361104,121507418,15780089,45455857,114346160,43264206,65411860],
[132865881,33161182,43993556,81856343,51531304,124499053,15690348,82063242,15878775,132193617,12705936,114881635,121145360,80653495,98906877,96324893],
[21248905,15351708,59761526,79590284,96380432,76469042,83475228,128213136,4463533,61821515,23592266,59639719,6510373,42551759,126967960,62215804],
[25580844,26165052,123287334,77446885,102636222,38671610,22054626,33239645,128031811,19089440,93503334,117988287,68351923,37443,72218597,28701717],
[98851432,44516464,83452137,2427210,11461618,111168695,106037532,52740578,73806346,7400020,10604925,57733815,56663137,117195155,58828437,111649025],
[118649770,21532459,28110204,50181496,61535869,16094799,82532204,126887626,118574922,34863745,105965883,70256166,58768667,79423570,130315968,2326877],
[2738007,123805319,67859617,17408361,42429361,36073248,60054135,44435800,35352108,71678236,4393420,80357470,56606193,127896200,68869448,93986047],
[4765681,129770276,92637533,11344631,27575438,16637054,49267958,121131814,22994425,3884902,107444033,47140325,3605452,104763638,128546379,95634499],
[1166507,118955479,57478517,37054227,26698792,3358788,17508094,30655727,129199145,120842538,106127120,67596917,32343846,134093772,64328327,70850759],
[42962307,29629401,52073036,113594172,35056167,91635500,18675218,36074742,7405323,36040710,33938592,69219377,128684830,128512522,67531650,25490119],
[127229539,115557198,63672286,128235189,32618935,80072770,92075426,64751968,54062869,132771222,14376285,117124578,1970150,45555770,77009477,9315327],
[130258601,120271797,75308185,19007554,75156739,24656818,102348947,130421271,33740916,80036115,12885140,53061699,58759993,41332828,17273900,129795604],
[122088642,34328646,113139739,92176830,69288747,11922444,82178102,47090848,113116806,82619580,110173118,133317157,56615362,15388316,129098264,114114991],
[109758192,95502095,10403347,82950598,17964538,39852525,81694827,89984555,31463834,99115264,101073828,106097253,34804956,84092108,102983511,47282794],
[41742723,96510797,10669715,120845024,104640268,117726375,102593122,78864696,58509926,71944751,127755696,75277546,62554525,57009028,123775587,45268602],
[133017062,49745171,16438986,14864064,5851038,51168418,123080146,64926425,58150560,131216881,87855503,129866080,2289330,83268708,95696910,23272536],
[93683396,17756792,118578098,96357101,15434715,47524952,81888594,88666039,72641401,114751479,89352476,81462208,112136155,125254708,65750800,105460720],
[128994872,125593001,22376637,26619224,48511436,129216938,79121096,82009956,28292073,118929992,88346126,97999347,85852991,15722002,4282323,116332487],
[5476297,130607205,40878444,46687035,60862994,115895085,44570772,105934798,86142081,47607915,16839917,95475128,133266716,17514979,56908609,62781151],
[63901727,28696469,46120009,87767544,108389088,70407232,28994514,15361093,59542635,82090793,88075957,49299814,66338265,39887097,131729894,104842509],
[71770407,13831781,96244088,25681386,88591501,60708013,56801654,108881179,96571861,10624394,54094468,83402727,56007763,23165423,71558017,20908163],
[114228323,5960292,102223441,56178639,62653504,19609669,70286265,82797457,78684625,59979788,112246569,38396579,58886543,71776665,90996919,3383285],
[15901072,17192415,131354644,6805761,130316286,14443156,106689543,97329783,117953704,93255815,113868818,117363091,20009080,33233334,61793215,19028501],
[26906595,6136508,31139683,11220287,68213130,85319700,132779952,40019735,101775405,18551242,68417739,52767740,33760618,130275528,8522433,84302233],
[103152709,36803284,6643127,125860230,77589774,115993721,53496887,21122445,134091725,26756899,47026010,93718280,33798251,100257403,19737693,15292529],
[28509247,11676312,103565179,31369921,112563786,111321169,48716361,19320038,61776241,17983611,117072854,93889539,79626568,93539277,114180091,15956576],
[157004,170802,143143,382755,344585,179685,509065,3062,61158,365802,264275,422269,148556,355042,64989,521496],
[90337017,3973351,51941070,109123531,220930087,190187520,235065766,201159125,260399648,208394529,179354667,60241042,193218839,23098797,76271356,110802023],
[84746801,235557398,53558500,236757136,214564807,217524548,223303881,106471480,267297024,177643255,179472407,143235530,244493894,98102283,169952204,204966697],
[151653207,183331907,142572826,235527161,226936677,255613454,186675112,117461618,66451576,87233960,97294908,115138224,152674358,234973280,89394356,190763971],
[138369142,60923909,127888575,103024358,218560567,115103513,167390493,244687899,62524845,88203883,3692946,172114152,185006299,63912429,175967546,26546108],
[225843121,17802902,57941190,264091541,169742552,150066088,249791128,172752530,253518696,185341078,252527086,109077292,130073844,13817285,179977797,244323219],
[182111147,190385366,135218609,84623713,104094438,4155531,195724609,205310325,267679977,209819889,146651312,224362247,73211677,202089932,243170964,26681266],
[140264758,7246734,79384021,135808220,211602975,26931962,264540786,74212943,201877781,203327954,122957958,206965016,79781888,81384716,260695723,93146178],
[262125432,66898170,63070253,210877173,178993829,211626726,49239540,154623928,262299693,76627734,35388150,80205751,36248471,96334768,234477978,45529400],
[76266828,193367028,236382557,223058624,89771163,54542630,209204843,146931592,201132926,149605824,206271997,21979221,83415284,222586325,264515452,126271627],
[51324966,244462338,229578685,187218746,235363815,111603633,224104713,93544584,188531174,225286869,267969283,76641375,252966562,85313610,123042870,132345899]],
[[33643808,130281282,33754786,112701204,59519535,91713278,95942746,101220910,119194381,48549202,36932154,107972101,39682001,125123156,77842470,36424224],
[51346561,133707349,70175400,1712543,84970450,112691899,129183211,70477115,127760293,50857675,110642662,32984398,83375299,111858112,71925488,53375607],
[12506831,66181126,6938632,114588666,66998773,35626100,112108277,4764741,57372875,79650418,102327670,44965008,23181368,76981050,74205469,86459444],
[13274472,71639306,125651010,130630888,3467664,8689320,93256560,74554975,47085127,14602270,16947281,21166210,41687071,123723931,88008355,131145983],
[83907683,73491139,68377096,40617089,84575724,51407460,70600001,123587644,76047893,20094992,94258745,100998166,74482942,59831677,42500398,6319103],
[125408392,51581716,54776951,107215998,23543230,116070466,64114698,126126577,73020278,77833541,80681313,132046871,44642382,83692719,27239664,20161951],
[103784409,94058333,94272929,84356654,61538965,38908932,6244020,126677469,116547881,995877,99972476,25111764,109924595,29959593,20820279,121860977],
[89208618,99858208,80862436,74430266,85308241,61553451,1158014,18296924,6450863,74213536,84965656,89947912,16588650,59357226,11844565,90401290],
[14292450,13966369,59540433,116243452,35309721,102961001,64056202,123488256,100842917,44211174,43864594,91309040,123050674,122831504,43455803,9724897],
[60474332,67689842,11651295,80724530,4159152,132973724,37076028,17175590,107709543,83210645,121613418,95241424,85072797,43002495,22972321,26397979],
[59439402,9754718,51461991,9034726,84703425,57204972,3406421,65053882,52068077,72401867,69674885,9302087,127745856,98890261,28749189,66507301],
[113473396,69801393,129243367,64033061,119090026,393112,44615177,83220278,57352127,117691772,48861353,59224118,86356926,38681597,108777916,131487287],
[122703928,23375850,5296175,10369755,25426304,123233388,82041110,14806582,40141371,35014852,39008145,104621086,106006863,124163305,89258607,46367089],
[76860526,130387771,73308228,36694305,68821806,81350295,98110517,130853572,17193808,103994418,40149580,69713318,71793630,61127770,44375896,19198203],
[53310554,63475008,50033654,107741869,30890975,129706414,67048961,108024661,70226587,76248693,43394010,101281445,84847999,126322202,39224571,97161361],
[118241959,29608009,3960333,5402323,101379163,21787540,131346758,98041498,76660098,88967988,62859135,96282138,43050257,6077801,49326799,19815293],
[74872629,32913740,67676185,17768960,80232946,117575386,22523150,35281742,92184273,112390487,37733899,127130247,12693466,44517113,77302412,38875268],
[104526314,68010032,24885516,2826557,40761888,66345654,111147810,119129797,69539189,128417753,10822273,23282591,99865630,35504360,70183628,31156352],
[67706483,35306554,132553145,105277463,98746654,60761093,121758789,14625858,32876023,117271467,51933545,9769279,133758460,19026459,64146573,9158937],
[84695654,19143052,65828402,128104191,56318159,2184789,54252978,117609006,27746695,5863715,89882948,107070048,70278912,108985049,9081288,38809014],
[89103810,126618872,99275027,80567685,79936041,67173101,108014708,64764723,95353435,115159384,111246298,126098563,71492966,103105662,109634409,1324318],
[8614022,43343892,24773572,127364873,40490107,69097875,26990008,91887650,6078915,50473496,120575870,91760875,87025864,34097200,114322299,59853670],
[30228360,53341337,105087688,76926685,24876217,45455187,39888099,34060948,32840509,90443236,88293608,20016838,35661116,54848525,68190529,113878420],
[42683420,57778457,60886699,67989920,111458784,48793554,96824794,8223566,97636805,124190611,107738354,110123919,33920123,60166446,64305101,105138240],
[47062745,109472248,119135623,36719712,54791264,133466708,109142802,84102501,125224963,25397888,24864700,102672344,61681400,79327514,54541293,133434575],
[45186477,14205837,108738548,54800722,79445093,17950745,106067837,26297808,71888359,88667704,37058348,9334525,28794753,36864254,69676639,53018331],
[115984036,124461352,85964288,86301143,104132861,96775845,20044534,39002072,46507966,120456932,66496710,42961833,92345574,17479973,112689563,61888115],
[133036121,54021795,99544759,53592440,4028991,8152444,133358577,133941046,66526565,94075564,16044120,41667039,67742726,84059144,9029142,129944248],
[43878167,119739118,79431805,58505763,96810758,127950371,52009393,23847967,114773316,42227066,134107920,60244143,88544278,10319164,24228746,85587903],
[84481,241723,162056,149194,197078,11467,412326,154094,37155,305955,469835,349274,445602,226301,213436,460214],
[4980025,40545752,11123081,264291952,27550860,222949761,139940810,195124088,231592505,236913974,255203778,258048630,69273553,21934783,146330601,114293964],
[164741273,131289751,168358658,256838384,134167563,97258398,230338447,33319579,101412229,142468264,191538321,154799679,242247295,153873970,17275366,204611081],
[48327741,76584159,211411472,134831834,238797322,98319746,132421646,61758654,175556126,51433036,81024233,265642764,167280188,14627588,193330595,175954376],
[4076310,261053923,109382546,176085089,262725355,169090488,216394470,43038009,254793834,78933811,134641166,22180732,79762720,134923242,180670187,48937212],
[84386297,174672633,249718773,58300792,221626154,28061539,163736616,183414760,32104035,215576929,122293344,138335942,37081014,63334136,7151046,32371664],
[253556965,238079391,232729806,168062494,115714645,188261697,253718071,160048785,240357954,108377537,108507484,159883981,195016863,143615157,188065221,164850422],
[69136985,230681557,9384536,86861786,255746291,199361034,130737884,102590583,100105181,132052583,260424400,148788618,168907001,180016278,102276925,244649070],
[252447717,246798669,119658956,199375201,109845801,254434743,71546897,1376377,243794909,126159498,203659663,51795063,256091114,222363993,87791600,117715674],
[250867458,228362778,210501172,104149740,256010809,1907435,26132588,181885611,157792815,149653210,189117649,4012843,43590132,208928194,9877865,105849275],
[236690105,211970090,201349695,174175945,251463222,261364504,125442988,120845919,86418134,22413206,51190573,161262156,73617425,55173291,248326921,64829998]],
[[9355902,127890341,100207028,124684326,131341754,29096749,61449558,98690644,107125486,53210509,90823704,111633226,66396052,2380588,2539697,112228377],
[17342673,38216270,72249716,82616493,30626559,88403858,47599561,61600794,5420388,41533082,85270076,79694968,99213309,120553160,10609021,103844609],
[70788483,23382782,56516028,70587039,98201478,31996976,81260808,39346658,128039684,22713047,6000540,92712719,49489014,14591294,43895180,75216699],
[47309761,133609,51066592,105490828,51930040,4154234,12375246,30125219,10056550,24298272,113607614,10406821,86713448,83650552,46500104,23783543],
[24422457,31739303,15814419,21362416,53957478,130162982,38047531,22022245,109295178,85581597,70692056,97579953,49093818,15458871,90393840,25457939],
[73186970,76503209,129585348,86133857,53291220,111647493,47855331,39995607,74760519,75117600,646192,117595152,74386488,47698978,73463152,52689285],
[62516825,95018982,36262164,81909737,97497994,16763493,108769427,132985816,76285203,39232981,7971897,58942071,61027798,132977128,102701793,8151362],
[95375837,131215612,43230569,95872668,64570658,7532773,91412732,12403995,63973814,112020527,116505883,119766815,112794281,15882802,40464407,23083028],
[142764,118610282,130123010,72356614,30562275,61295691,89921345,116210813,20828830,15402629,119497619,129902568,131896928,103778740,90365368,117315612],
[114350895,45122259,130160566,26716618,81972592,21992797,88334108,120237830,48512009,105088960,109772757,94121956,27067956,82104249,61990199,115015652],
[47460979,119457288,8489369,8068911,30417953,52524668,123423098,88321886,15958535,69563894,45307461,130066764,16533812,46824429,62933701,122963648],
[10117877,59580437,68275993,39957714,92751897,80297345,39703187,16000462,82539706,87117435,91632531,87633903,27000745,37844198,110099826,30566048],
[112584969,31532539,71405629,60747122,64815354,105632221,5447185,108795124,86003229,81997374,129916287,57144005,10982518,120923612,18895512,27973049],
[131134853,95371227,59440562,120725395,75725895,108570449,127985145,91624302,24937168,129061918,82840573,119590331,35965282,96619333,52184912,29525666],
[29223364,22760781,6387939,88446965,56817986,59460371,76532093,5596338,66033952,97469649,111716125,64622899,33030978,44627009,63087864,109874031],
[45049250,43450124,39865245,64535411,100642897,76932514,99068753,118106442,13151274,120582988,54020921,59155977,77157648,7015844,104008483,105145084],
[115142665,8318539,59526401,96297777,47837454,4311035,131178529,27914991,10348102,33283413,24144789,66994973,111536789,44192082,3110993,27807435],
[59234576,107446412,59876669,1990106,100024572,11088706,40948068,79161326,23081098,41645466,60872639,64491509,81299306,25388817,29106419,88227207],
[59670494,58334486,13206426,24534232,55704199,55163999,2628419,65298348,28215630,60603281,14207378,70628076,106065107,68379045,90304699,130449818],
[31167845,52726320,71606973,128196013,7173897,51043853,57548254,7481569,22273879,78287950,68738675,112812174,119021389,91086650,77419300,40067606],
[21841893,101228637,125979777,24304208,19005192,38342222,104612322,16071703,4163994,101797594,84964311,35769644,80781607,20959056,76360097,75084404],
[18499202,113105412,56178047,115272188,79203644,74301867,57476619,44985671,126337882,116612848,21669506,39526599,12417065,19543955,88395982,92242178],
[86024467,32191871,22947152,8541961,53831863,97854159,123950017,92227460,126978291,28470231,33503813,21648837,107344672,54844685,43541263,114604645],
[17029764,53261059,116681332,33105137,12898000,96361173,88397603,114585814,32086764,113153775,16693279,69110599,76909983,40210283,99670505,26776362],
[29980126,110605737,86650446,123044202,69303769,87822770,122531289,116314339,89836846,87830543,3040250,82883509,114374709,34399736,120037916,68037573],
[30830716,28007735,14931289,49471221,69586543,70260720,103933815,113165828,9139870,64623990,130775045,76797263,43554685,15135864,85141367,40553409],
[86919612,37501669,98198954,126430566,19847324,103505012,60659933,14556154,116251909,66164538,127310041,89326682,74578774,55302354,23693846,104474691],
[58454719,68641657,84554319,64673027,106163246,47266344,40139503,85325116,109048725,71393165,86378468,84048010,95964306,117718296,73815511,40785194],
[85399772,36434430,90393751,90032098,16862205,116740754,7091059,52658990,111960563,72063463,308897,61397358,52021176,128157076,29123658,35543349],
[327091,472675,298109,107666,224629,182691,33559,137183,152101,515014,174224,222875,50839,257768,3826,283446],
[69218592,19371675,235519464,178810924,59839809,81278602,45198364,181235912,53777123,57389599,145800093,170107427,200920035,43649543,74821303,227341291],
[258439554,150608530,167552362,141653033,206772936,38192643,10110557,258686788,70111067,244373133,169373957,47027709,253817236,153589672,134163862,229322766],
[267559636,154231609,232540980,258276803,31623958,187809020,7603048,203235159,161948651,6552809,65715119,16180578,145705866,9918905,198978771,138183403],
[208168260,124688312,81878386,118392408,237246763,176167815,208698692,189905633,20894879,193427418,226597760,129942801,95233568,8130319,69380099,72418884],
[134773610,261352720,56661775,12742880,138791521,128975577,69147233,199595933,87348088,114281391,162549193,142065825,107865537,148512386,40312947,139672585],
[63922096,65335559,200887844,71543905,118239489,174971354,244726492,45539360,173511817,264233320,219074279,97904988,130524103,174748374,244351308,2901397],
[83612114,98578869,247629332,200993315,59314276,197713671,268178115,76970310,92066097,81651837,47949153,116861056,85963045,83538152,53793865,68025311],
[29399692,80199695,102668303,257531146,161867083,144181009,24779886,152522953,263505690,211054202,114306859,74643128,230987659,5492260,55598020,195854101],
[212844239,32835502,49499204,19281344,102210785,37185074,67342836,61441574,213124159,209371326,246803775,34870710,106521975,75981020,184583231,83302894],
[146776674,78169339,141145888,47658289,98121267,78407763,119107404,112868568,239492317,25891572,89762668,258953515,180870450,107413368,236471806,203650226]]]

original_moduli_rot, extend_moduli_rot = [134220257,134206049,134208961,134207329,134208257,134207681,134208769,134208097,134208577,134208161,134220193,134213857,134215009,134213921,134216801,134214529,134216737,134215553,134216609,134215841,134216129,134215681,134219713,134217089,134219681,134218433,134219009,134217409,134218081,524353], [268435361, 268435009, 268434977, 268434721, 268434401, 268433761, 268433569, 268433441, 268433377, 268433057]


TEST_PARAMS_EVAL_KEY_GEN = [
     ("0",),
  ]

TEST_PARAMS_ROTATION_KEY_GEN = [
     ("0",
      16, # degree
      1, # rotation index
      [6, 7, 5, 4, 0, 1, 2, 3, 12, 13, 14, 15, 11, 10, 8, 9] # post-rotation index
      ),
  ]

TEST_PARAMS_ROTATION_KEY_ROTATE = [
    (
      "0",
      16,
      1,
      [6, 7, 5, 4, 0, 1, 2, 3, 12, 13, 14, 15, 11, 10, 8, 9]
    ),
  ]

TEST_PARAMS_ROTATION_CIPHERTEXT_ROTATE = [
    (
      "0",
      16,
      1,
      [4, 5, 6, 7, 3, 2, 0, 1, 14, 15, 13, 12, 8, 9, 10, 11]
    ),
  ]

class EvalKeyGenTest(parameterized.TestCase):

  # @absltest.skip("skip for now")
  @parameterized.named_parameters(*TEST_PARAMS_ROTATION_KEY_ROTATE)
  def test_rotation_key_index(self, n, rot_index, expected):
    result = find_automorphism_index_2n_complex(rot_index, 2*n)
    key_map_idx = util.modinv(result, 2*n)
    out = precompute_rotation_key_map(n, key_map_idx)
    np.testing.assert_array_equal(out, expected)

  # @absltest.skip("skip for now")
  @parameterized.named_parameters(*TEST_PARAMS_ROTATION_CIPHERTEXT_ROTATE)
  def test_rotation_ciphertext_index(self, n, rot_index, expected):
    # Ciphertext does not need to performance modulus inverse.
    cipher_map_idx = find_automorphism_index_2n_complex(rot_index, 2*n)
    out = precompute_rotation_key_map(n, cipher_map_idx)
    np.testing.assert_array_equal(out, expected)

  # @absltest.skip("skip for now")
  @parameterized.named_parameters(*TEST_PARAMS_EVAL_KEY_GEN)
  def test_eval_key_gen(self):
    sk = """
Element 0: 0: EVAL: [776745731 887044058 1062660819 738880639 184165177 610227253 75339555 1033651173 725265328 489214328 504239593 672869117 954772942 913502666 447815481 661034950] modulus: 1073742881
1: EVAL: [974473900 741981661 807803017 194160953 274321553 606271089 854517514 915183918 548019162 1010598052 750522086 409280231 322928459 727504090 253411661 272707143] modulus: 1073742721
2: EVAL: [688580529 840461479 222492322 1051014605 279655414 908126675 971362280 407013901 523612320 141294066 196204483 867696625 1056403314 641961221 530580264 337213471] modulus: 1073741441
3: EVAL: [96530276 527493554 261085438 115927669 522626254 627962386 950032483 119567511 831431159 936928865 230292505 76126265 9526389 177900656 1041468343 991293246] modulus: 1073741857
4: EVAL: [223935 258096 403937 157271 253161 418285 470764 436316 186672 376794 389479 90294 304624 361718 111291 276540] modulus: 524353
"""
    sk = util.parse_ciphertext_string(sk)[0][0]

    a = """
Element 0: 0: EVAL: [127760070 983718120 431735721 111729112 590264373 812802632 713335606 596646869 992672756 467404807 541763077 89188893 574487439 543175151 511922628 121352965] modulus: 1073742881
1: EVAL: [597433168 301049176 756588895 655212114 1053608064 32703136 693636529 613590261 526467299 1058450490 1018263151 548200748 468356029 937114608 119676856 58190992] modulus: 1073742721
2: EVAL: [127267463 127588790 913001791 108124297 860165403 137617318 753134915 823734955 13450913 1061996618 908341430 597623859 735810307 154446930 883666193 970327270] modulus: 1073741441
3: EVAL: [994798434 179028393 286844155 361136254 673690448 262427139 795061553 180229027 277033738 284903911 532736751 383121646 696565763 744344010 762537850 529981529] modulus: 1073741857
4: EVAL: [421138 19613 385629 211850 16354 37376 165676 443165 340703 66392 176196 477290 262145 207695 405264 50265] modulus: 524353
5: EVAL: [362657350 280752185 552481399 852160879 200025962 264673286 1064434691 39575836 954108874 963317839 270791516 602900292 745507087 794853253 358209012 1053724630] modulus: 1073740609
6: EVAL: [898124405 1046127316 53864791 917439843 1025332212 1036440271 133377116 901550128 944825173 828743422 717366601 493377578 557401849 737047782 107204539 385620098] modulus: 1073739937
7: EVAL: [482259244 83193159 836792051 962621377 818169206 811696598 183545584 780386766 836923265 160827384 165460728 576306060 135849097 639235300 122931467 655366461] modulus: 1073739649
Element 1: 0: EVAL: [454552227 1031414825 992753374 1062398679 473835735 178893472 100932164 376634879 491269188 903649210 963028556 917888156 721545531 855981881 97765786 992036622] modulus: 1073742881
1: EVAL: [938890279 28685089 77231566 179806261 813793035 930273557 1039714600 246330744 36431209 280483920 223570241 833503091 301740795 495527033 326547229 861221379] modulus: 1073742721
2: EVAL: [179153300 775749439 322774550 76874121 286363472 627370776 588958934 876835724 777896594 693567743 767151711 891587229 397324662 874562015 50449308 454495257] modulus: 1073741441
3: EVAL: [908737664 699338311 274242336 737976310 330604870 1048289062 683248638 829882634 241789439 176733590 541268106 557216528 417737830 125951194 981603452 735837321] modulus: 1073741857
4: EVAL: [300610 101507 193397 33900 133500 96441 235411 148136 464461 82288 436889 433691 3992 148317 79281 183898] modulus: 524353
5: EVAL: [178487484 983964243 87476879 507414112 691079501 932901558 37972904 972293068 951261069 544735723 866407561 47197734 391257010 1069163105 732495583 407784333] modulus: 1073740609
6: EVAL: [525297134 22700713 928196847 564500854 705600186 936418549 780381466 929284142 248532921 443231684 833552060 90371196 437856635 913242504 364751039 34496982] modulus: 1073739937
7: EVAL: [657003279 639382784 438257780 355333920 114059731 269206628 52493576 867028245 725720431 27333486 552223203 432833316 616147209 753694217 628258531 716500206] modulus: 1073739649
Element 2: 0: EVAL: [706938922 462799945 351578406 388175273 454331523 930792349 1057301227 787354559 233045800 110259746 297141905 184816016 533700849 336123829 848378864 713609554] modulus: 1073742881
1: EVAL: [659963812 1051258275 597997594 964830830 7552238 720381763 889653483 1020033132 74188522 1012082560 701663777 184418618 765173617 21445100 285153426 617067641] modulus: 1073742721
2: EVAL: [630148906 882616654 34488277 333567297 257632625 455781363 295642781 157217366 557189148 521449760 754198996 74787909 519095512 637452092 601849596 765711385] modulus: 1073741441
3: EVAL: [584850505 647056672 665535434 751142571 898749586 833091164 421260800 340821970 612048100 175640489 411040300 871748794 531305017 29312066 805254026 557265039] modulus: 1073741857
4: EVAL: [179041 429472 181836 304284 94228 202931 152216 498775 348000 40944 11743 358237 459476 468992 304601 72150] modulus: 524353
5: EVAL: [158244937 948803020 158724932 519097342 751534116 889633976 643206869 1008256124 316718678 292511413 187282457 450048010 543707093 514636391 319965997 241550393] modulus: 1073740609
6: EVAL: [187653789 598073421 736500737 974684977 354978885 395354235 923426224 775400044 537297059 1056499332 939589727 662435841 288846227 978632424 882875138 48949088] modulus: 1073739937
7: EVAL: [451188453 169776810 591329827 1054874703 1023000955 397895212 755460303 684530672 555875809 702758511 1050942848 500259809 1021217482 377144768 941844688 932945536] modulus: 1073739649
"""
    a = util.parse_ciphertext_string(a)[0]

    e = """
Element 0: 0: EVAL: [188676569 418502134 958738314 94710688 579884036 198755157 624640766 421978677 492912282 1040040725 791623135 992637799 428055269 603699180 394964232 360124053] modulus: 1073742881
1: EVAL: [987784621 519316809 231811241 342606963 1024943144 664923124 339687235 455526328 97705393 949799579 564169492 397400399 854611163 594861034 573680795 1064857137] modulus: 1073742721
2: EVAL: [889129938 200087624 250466208 484480705 20050574 49648421 883997952 453290019 355358169 675098331 681511199 49661579 7723987 527610196 167120639 747213073] modulus: 1073741441
3: EVAL: [82250786 1059796432 877073460 451784453 280168931 565986255 897978524 165292401 21140964 748374763 688612265 802163809 807198339 785444863 266329421 90339158] modulus: 1073741857
4: EVAL: [368899 212931 332333 296169 191800 464422 172073 370569 53137 501947 105099 259683 514836 266384 72032 12478] modulus: 524353
5: EVAL: [319127549 265950061 741116027 335694081 776781734 10623404 836277508 156232229 176064488 704022880 195898977 423626387 1054905610 593529307 459737316 466596673] modulus: 1073740609
6: EVAL: [1020003021 674132141 531674792 150921746 451989956 1002102152 369311352 599278118 68460018 327161977 582565126 463516738 382380869 926101408 425217185 615102865] modulus: 1073739937
7: EVAL: [1033603948 1042520617 545183769 862891770 184683114 110416812 850532226 535988524 363548901 847079540 546255959 342930120 437546321 215642075 573782265 97311199] modulus: 1073739649
Element 1: 0: EVAL: [527396731 3741087 222774090 884140898 402922264 926759953 483486269 843750224 631734004 989488287 100438672 349720074 143405020 288849669 716269722 1323187] modulus: 1073742881
1: EVAL: [97537924 171585095 287273805 763563046 1058331066 978405249 295766203 642508488 872918729 381742965 349203757 365528291 717914063 705399157 94845197 807418717] modulus: 1073742721
2: EVAL: [370269955 193631962 803132083 889876200 119456448 396032898 128673347 320151422 502953039 816508630 156192812 798791740 440635658 781966319 263748461 534169097] modulus: 1073741441
3: EVAL: [151330601 590549465 437049993 517059862 543558050 987701085 803669953 264048411 329704682 228402646 455744908 365973566 281028490 546593222 228449382 785328667] modulus: 1073741857
4: EVAL: [269384 22130 473396 456665 150908 415837 361902 471535 1690 347756 256812 258637 478599 4423 278901 470586] modulus: 524353
5: EVAL: [140600324 979090783 995068829 231349239 223702215 241122704 821304784 662723550 118429251 684623756 503448650 304345180 1022941667 685338332 734229186 241606406] modulus: 1073740609
6: EVAL: [497446499 345222484 908723240 403745960 933027617 48120112 124205082 1034468746 248336385 892151790 629680898 528493875 897583795 1032179472 590949367 549324095] modulus: 1073739937
7: EVAL: [649376537 772666056 1030756772 110076457 613812339 579997522 573373694 1038638860 186076764 860386428 653614417 676059458 391454430 889324908 684601566 1027180266] modulus: 1073739649
Element 2: 0: EVAL: [194431815 371399517 825946264 361260898 542225765 429902379 867141644 99627381 816989407 801033176 963789759 301555765 551745647 979951224 806986754 749698550] modulus: 1073742881
1: EVAL: [902035287 109754676 619819881 571531074 783631287 817162160 495698494 195866564 958743830 533867970 386833860 647067489 87253504 348504848 345205914 786964946] modulus: 1073742721
2: EVAL: [934434965 32647848 1056134500 236087069 837860822 33956735 45431825 579059504 971322413 429842897 629893328 186887475 343854584 925471055 104658327 168646756] modulus: 1073741441
3: EVAL: [368895616 576252350 1035240653 407147780 451143994 231840048 946391345 793585621 774250676 748606426 550843900 51844795 1033928327 600884101 1001535701 91285396] modulus: 1073741857
4: EVAL: [239361 316921 499427 302906 105382 388289 333887 357650 168107 504397 310434 296621 26634 439511 211630 218036] modulus: 524353
5: EVAL: [66591336 147499073 892202988 616477269 42726586 524088150 189581102 150039831 451109041 75322101 670787883 808241768 69399778 728001453 231188270 779187041] modulus: 1073740609
6: EVAL: [602507244 493953218 715726420 600946200 116451155 783190721 1030571237 362370143 459518530 92309764 743967098 884639164 13462121 482655776 545408229 662242492] modulus: 1073739937
7: EVAL: [123286527 127947191 547100757 1060692707 195612987 441992039 548653549 1031957297 978385338 124231098 674442462 229660897 657052699 345705026 914298502 588898132] modulus: 1073739649
"""
    e = util.parse_ciphertext_string(e)[0]

    ek_ref_a = """
Element 0: 0: EVAL: [127760070 983718120 431735721 111729112 590264373 812802632 713335606 596646869 992672756 467404807 541763077 89188893 574487439 543175151 511922628 121352965] modulus: 1073742881
1: EVAL: [597433168 301049176 756588895 655212114 1053608064 32703136 693636529 613590261 526467299 1058450490 1018263151 548200748 468356029 937114608 119676856 58190992] modulus: 1073742721
2: EVAL: [127267463 127588790 913001791 108124297 860165403 137617318 753134915 823734955 13450913 1061996618 908341430 597623859 735810307 154446930 883666193 970327270] modulus: 1073741441
3: EVAL: [994798434 179028393 286844155 361136254 673690448 262427139 795061553 180229027 277033738 284903911 532736751 383121646 696565763 744344010 762537850 529981529] modulus: 1073741857
4: EVAL: [421138 19613 385629 211850 16354 37376 165676 443165 340703 66392 176196 477290 262145 207695 405264 50265] modulus: 524353
5: EVAL: [362657350 280752185 552481399 852160879 200025962 264673286 1064434691 39575836 954108874 963317839 270791516 602900292 745507087 794853253 358209012 1053724630] modulus: 1073740609
6: EVAL: [898124405 1046127316 53864791 917439843 1025332212 1036440271 133377116 901550128 944825173 828743422 717366601 493377578 557401849 737047782 107204539 385620098] modulus: 1073739937
7: EVAL: [482259244 83193159 836792051 962621377 818169206 811696598 183545584 780386766 836923265 160827384 165460728 576306060 135849097 639235300 122931467 655366461] modulus: 1073739649
Element 1: 0: EVAL: [454552227 1031414825 992753374 1062398679 473835735 178893472 100932164 376634879 491269188 903649210 963028556 917888156 721545531 855981881 97765786 992036622] modulus: 1073742881
1: EVAL: [938890279 28685089 77231566 179806261 813793035 930273557 1039714600 246330744 36431209 280483920 223570241 833503091 301740795 495527033 326547229 861221379] modulus: 1073742721
2: EVAL: [179153300 775749439 322774550 76874121 286363472 627370776 588958934 876835724 777896594 693567743 767151711 891587229 397324662 874562015 50449308 454495257] modulus: 1073741441
3: EVAL: [908737664 699338311 274242336 737976310 330604870 1048289062 683248638 829882634 241789439 176733590 541268106 557216528 417737830 125951194 981603452 735837321] modulus: 1073741857
4: EVAL: [300610 101507 193397 33900 133500 96441 235411 148136 464461 82288 436889 433691 3992 148317 79281 183898] modulus: 524353
5: EVAL: [178487484 983964243 87476879 507414112 691079501 932901558 37972904 972293068 951261069 544735723 866407561 47197734 391257010 1069163105 732495583 407784333] modulus: 1073740609
6: EVAL: [525297134 22700713 928196847 564500854 705600186 936418549 780381466 929284142 248532921 443231684 833552060 90371196 437856635 913242504 364751039 34496982] modulus: 1073739937
7: EVAL: [657003279 639382784 438257780 355333920 114059731 269206628 52493576 867028245 725720431 27333486 552223203 432833316 616147209 753694217 628258531 716500206] modulus: 1073739649
Element 2: 0: EVAL: [706938922 462799945 351578406 388175273 454331523 930792349 1057301227 787354559 233045800 110259746 297141905 184816016 533700849 336123829 848378864 713609554] modulus: 1073742881
1: EVAL: [659963812 1051258275 597997594 964830830 7552238 720381763 889653483 1020033132 74188522 1012082560 701663777 184418618 765173617 21445100 285153426 617067641] modulus: 1073742721
2: EVAL: [630148906 882616654 34488277 333567297 257632625 455781363 295642781 157217366 557189148 521449760 754198996 74787909 519095512 637452092 601849596 765711385] modulus: 1073741441
3: EVAL: [584850505 647056672 665535434 751142571 898749586 833091164 421260800 340821970 612048100 175640489 411040300 871748794 531305017 29312066 805254026 557265039] modulus: 1073741857
4: EVAL: [179041 429472 181836 304284 94228 202931 152216 498775 348000 40944 11743 358237 459476 468992 304601 72150] modulus: 524353
5: EVAL: [158244937 948803020 158724932 519097342 751534116 889633976 643206869 1008256124 316718678 292511413 187282457 450048010 543707093 514636391 319965997 241550393] modulus: 1073740609
6: EVAL: [187653789 598073421 736500737 974684977 354978885 395354235 923426224 775400044 537297059 1056499332 939589727 662435841 288846227 978632424 882875138 48949088] modulus: 1073739937
7: EVAL: [451188453 169776810 591329827 1054874703 1023000955 397895212 755460303 684530672 555875809 702758511 1050942848 500259809 1021217482 377144768 941844688 932945536] modulus: 1073739649
"""
    ek_ref_a = util.parse_ciphertext_string(ek_ref_a)[0]
    ek_ref_b = """
Element 0: 0: EVAL: [518837131 847675960 670388006 822222797 105159804 382688312 221483670 360432126 552842074 234990465 224277554 1067695745 290316950 755369085 733560242 643013572] modulus: 1073742881
1: EVAL: [406724517 417652556 576995937 45531827 823189441 51705994 44281535 448207790 650253820 1019793611 475345040 71980502 351513434 761132994 1029045692 87848464] modulus: 1073742721
2: EVAL: [151672666 623008835 112895252 864058596 910885736 802880281 262883435 389310664 767937856 631704503 959638453 448162097 600214197 756046105 574509713 976086355] modulus: 1073741441
3: EVAL: [781831688 1015704899 677103210 964889319 150745741 105010499 259879873 284200237 1006127951 185038562 519598786 342737962 199552385 645745579 502204698 461324419] modulus: 1073741857
4: EVAL: [339684 279945 56670 348792 288094 228957 238241 278356 166797 227623 162090 409493 147785 446802 59503 327408] modulus: 524353
5: EVAL: [52508041 380315050 614909137 127163548 751454420 240323377 345098868 198018843 638746515 793626523 912682241 943488803 114747266 387714846 763268334 811064061] modulus: 1073740609
6: EVAL: [104052754 590929081 846790244 362497969 97714332 640050794 265316488 440779961 133384343 13961090 143576289 876417087 1000791509 555387688 656560771 382374581] modulus: 1073739937
7: EVAL: [293850165 135854962 410078247 513776391 882332850 595103880 997356596 732202239 794985314 678162288 807876327 1003541920 299454976 851547390 1062910062 613204316] modulus: 1073739649
Element 1: 0: EVAL: [76698610 122562540 421649746 441494507 115242021 259055411 968694151 895247299 85145120 799911714 675859446 392250754 50440023 701048912 981636000 1062972150] modulus: 1073742881
1: EVAL: [805696875 9541062 626617267 922670339 530626491 245653671 611154051 606624119 601530511 609886745 930265537 538685017 264293156 553844019 929505923 810379895] modulus: 1073742721
2: EVAL: [576929263 43839985 651112576 943046956 793444685 422737824 962104050 969903689 806110100 667212464 1028374038 116178265 491577202 854157675 44674852 236903854] modulus: 1073741441
3: EVAL: [585642377 631778593 73129972 1001833505 1009325135 325429762 42164961 201564319 1057860778 938711478 247075402 151240220 115065714 818393420 664217133 74949511] modulus: 1073741857
4: EVAL: [131527 244750 476759 66716 330023 117148 393154 212751 430801 240327 6717 294229 394198 253012 305061 217724] modulus: 524353
5: EVAL: [587521252 904702773 34476244 189881434 592506691 61747835 365167241 198453023 187869767 393357193 118871458 334867983 356990898 430364130 77334092 267739714] modulus: 1073740609
6: EVAL: [691231246 624844685 296762710 799417236 311195403 196458535 580123636 1031375026 688596484 376122945 1062633149 217296027 629090943 396618610 1057919177 567456938] modulus: 1073739937
7: EVAL: [708402909 828271106 340737624 401588486 224653790 757211532 716613616 801677486 499732317 451009036 652470672 840299783 903657546 459630333 497127320 817375559] modulus: 1073739649
Element 2: 0: EVAL: [894954176 862805985 1036302168 643160413 554990222 419250435 394443179 960418012 247282389 484196421 698899122 714025291 811620588 1006510078 441163556 219055219] modulus: 1073742881
1: EVAL: [268680721 26646997 572375058 870996420 609820891 120821834 536127183 452792173 561589766 368824292 302894125 968002671 612091106 372243610 664904242 831312074] modulus: 1073742721
2: EVAL: [340751919 240001329 394914737 310267148 214731198 654108780 20520001 527092968 98950497 821364040 113121158 431693049 547920968 953445279 639792678 463791267] modulus: 1073741441
3: EVAL: [1027938730 626992011 722321546 661767367 874757488 373997271 99495525 145261302 132865410 113282741 699257039 890486765 14763598 749224161 475308431 922043981] modulus: 1073741857
4: EVAL: [500358 215462 212690 496784 164816 371669 461732 264964 125632 387410 185956 239985 197253 351066 459324 492909] modulus: 524353
5: EVAL: [626315492 174302602 46285764 585942574 1016434114 57949200 408730092 646959673 73210983 272656677 991793499 660051311 234092486 10830168 877462792 128176355] modulus: 1073740609
6: EVAL: [133940838 710947392 843937344 508069163 663637944 638636330 819879909 403238794 503617786 135216281 937103765 195287454 910369575 238547265 497806718 837302577] modulus: 1073739937
7: EVAL: [292598726 458022001 126494832 1064955644 887346674 160411558 302720 857908128 410848255 962565225 785451110 604289305 31881767 459585928 472929588 623719032] modulus: 1073739649
"""
    ek_ref_b = util.parse_ciphertext_string(ek_ref_b)[0]

    original_moduli = [1073742881, 1073742721, 1073741441, 1073741857, 524353]
    extend_moduli = [1073740609, 1073739937, 1073739649]

    ek = gen_evaluation_key(sk, q=original_moduli, P=extend_moduli, noise_std=3.190000057220458984375, noise_scale=1, a=a, e=e, dnum=3)
    np.testing.assert_array_equal(ek["a"], ek_ref_a)
    np.testing.assert_array_equal(ek["b"], ek_ref_b)

  # @absltest.skip("skip for now")
  @parameterized.named_parameters(*TEST_PARAMS_EVAL_KEY_GEN)
  def test_pke_key_gen_reference(self):
    e = """
Element 0: 0: EVAL: [360471649 32171464 21820607 404562697 693084940 1007456063 974564896 800839232 149595129 777564569 532952838 112449437 215368778 117334740 790027675 525935501] modulus: 1073742881
1: EVAL: [677075319 176085956 359432035 521129360 351834497 119491022 1036981424 1052941295 29871821 629489317 56759480 268576267 1002801028 170012475 849198941 214518858] modulus: 1073742721
2: EVAL: [86150128 5616447 618857673 417830866 554269988 990975890 552866250 1068398546 62942033 359165661 161377547 16867163 862309862 426991911 1041999312 289570858] modulus: 1073741441
3: EVAL: [531597266 11926903 351369148 489972586 812077163 730995787 1054205233 312823366 678236305 683985199 803970423 671204702 168752058 1020388976 673738474 668433172] modulus: 1073741857
4: EVAL: [344172 332940 354544 365675 441471 73203 151132 34299 172444 2813 178982 340399 123179 510913 382901 385805] modulus: 524353
5: EVAL: [825378321 594589279 67495510 222461796 983433627 980854803 379302330 241446794 137935634 32826275 1047927373 123604455 894588355 687336716 14852375 282150668] modulus: 1073740609
6: EVAL: [825161265 264955538 590795464 1007266744 427099332 542494123 692745490 1018181753 945219035 20353773 22712362 161046318 508278682 958076563 99043737 506489365] modulus: 1073739937
7: EVAL: [667524206 966606316 239249411 481797641 402254997 543870392 905569509 88086148 919156416 777670388 167737485 934113732 305475695 995850241 736254877 532439435] modulus: 1073739649
"""
    e = util.parse_ciphertext_string(e)[0][0]

    a = f"""
Element 0: 0: EVAL: [907165158 98195037 595854409 518136651 930043234 723308668 281340633 427020404 714827365 77830223 198701389 353606918 638600902 862224574 235314242 50951679] modulus: 1073742881
1: EVAL: [58059697 911569878 182791879 1039226609 679749693 146760342 462866762 941623911 349255808 499730101 994727246 504808003 816044117 989480904 197823841 664988407] modulus: 1073742721
2: EVAL: [254318993 652853362 1004114247 634444616 178242913 627772844 791822979 741349886 387111185 567698889 1050207070 673053154 889570685 146227817 296022332 418894901] modulus: 1073741441
3: EVAL: [771558189 203153826 87179088 561421459 447066266 75242986 333773640 779462514 226498668 150243457 128424969 745418765 221525030 351568178 376917983 1009685115] modulus: 1073741857
4: EVAL: [116946 231951 267550 220344 262 411672 200379 310806 407307 358455 319818 505060 99100 450626 218909 35297] modulus: 524353
5: EVAL: [1049931629 8639399 607643844 534675383 853705504 892488548 954808933 171301787 72791492 737035399 579230690 445490121 192535756 789185457 876114786 153951840] modulus: 1073740609
6: EVAL: [891578495 282606686 202334544 1032041040 525672641 405465145 1049400138 963474772 451352560 563796825 478620986 391077012 466091211 770585781 1050825901 1036688143] modulus: 1073739937
7: EVAL: [346314060 612563340 207136558 831312327 464147209 1072673365 62737505 484646691 343744142 376562360 213440690 252446804 505279174 977488788 403862249 542530425] modulus: 1073739649
"""
    a = util.parse_ciphertext_string(a)[0][0]

    s = f"""
Element 0: 0: EVAL: [956285551 127499668 355441570 727621939 498271096 622086921 405014514 132043245 622651490 113820012 814608413 332940269 176207735 415242916 637898091 578566721] modulus: 1073742881
1: EVAL: [484993299 603526634 486685551 348907112 572981965 635874587 480297813 481175384 945709109 286124850 143743349 424346883 856612079 528551021 465345913 845066203] modulus: 1073742721
2: EVAL: [555177099 109048436 994480300 703739634 1064445772 383584958 475435571 548406490 942249569 413818561 705045247 290082298 867405715 1039159307 471207935 100386061] modulus: 1073741441
3: EVAL: [365495499 374720066 644060688 731189366 741862020 914412054 930793630 150645983 740808512 352464602 112607395 1046326212 129980097 412933588 269173699 672461429] modulus: 1073741857
4: EVAL: [481509 20060 93479 144016 516609 394600 513811 11270 495989 135787 312703 419328 283181 393689 257692 245438] modulus: 524353
5: EVAL: [660972969 354372447 75743593 716215670 527464929 793036555 205858972 479572184 327086211 513763298 963367580 852443868 817113976 780430240 513920491 8561873] modulus: 1073740609
6: EVAL: [109256469 546337981 256580548 489227456 423178661 1029855099 581576100 448190844 881501909 443025010 1059970349 966509291 80682548 192761866 638532217 442733132] modulus: 1073739937
7: EVAL: [343787691 15073481 372550458 243487526 211723083 758867639 239122242 180582720 529572204 977415282 920224865 33950106 295354899 463758495 428576769 428390418] modulus: 1073739649
"""
    s = util.parse_ciphertext_string(s)[0][0]

    b = """
Element 0: 0: EVAL: [769280489 965426462 497820260 324385186 142643175 852715611 1021255360 237414572 473872155 328283333 403852385 775444018 607208179 380527554 1015140293 828472603] modulus: 1073742881
1: EVAL: [245630080 854669671 796085711 580301753 558794024 727008550 284300972 484627408 1019704403 64398460 558905750 969057029 948464685 133578541 12611427 251563275] modulus: 1073742721
2: EVAL: [13767600 408180350 136925839 613360773 478731008 837341664 539396257 1004681261 867673619 658457829 579187493 457549906 891731734 247050050 535091168 1063146352] modulus: 1073741441
3: EVAL: [18655822 95181003 463470107 606987887 906288012 627530847 335534597 258885591 516931917 318850992 524871323 60279932 244579097 776433011 749013837 306499970] modulus: 1073741857
4: EVAL: [61328 504402 113135 99025 372987 434462 452666 453072 482896 65306 405559 193066 258639 459501 229319 520985] modulus: 524353
5: EVAL: [619897407 818716498 907556628 613060026 278274469 1029851440 892520960 1072901895 1025847770 921484389 19380 853415372 701339050 428650206 808542233 635378485] modulus: 1073740609
6: EVAL: [500106630 45170105 396688141 322715085 845740054 395947206 694837857 6882209 144055253 251301511 1011628223 347712003 314513882 846804851 842812939 791510358] modulus: 1073739937
7: EVAL: [1048630242 2968628 1007113137 672563710 96387664 913446766 873008182 374692612 625251118 587850681 184114803 425968753 276994999 786562010 734540441 26290814] modulus: 1073739649
"""
    b = util.parse_ciphertext_string(b)[0][0]
    q_towers = [1073742881, 1073742721, 1073741441, 1073741857, 524353]
    p_towers = [1073740609, 1073739937, 1073739649]
    key_pair = gen_pke_pair(q_towers, p_towers, 16, a_ref=a, s_ref=s, e_ref=e)
    np.testing.assert_array_equal(key_pair["public_key"][0], b)
    np.testing.assert_array_equal(key_pair["public_key"][1], a)
    np.testing.assert_array_equal(key_pair["secret_key"], s[:len(q_towers)])

  # @absltest.skip("skip for now")
  @parameterized.named_parameters(*TEST_PARAMS_ROTATION_KEY_GEN)
  def test_rotation_key_gen(self, n, rot_index, expected_order):

    ek = gen_rotation_key(sk_rot, original_moduli_rot, extend_moduli_rot, rot_index, 3, 3.190000057220458984375, 1, a_rot, e_rot)
    np.testing.assert_array_equal(ek["a"], ek_ref_a_rot)
    np.testing.assert_array_equal(ek["b"], ek_ref_b_rot)


if __name__ == '__main__':
  absltest.main()
